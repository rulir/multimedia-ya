"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),App=function(){function e(t){_classCallCheck(this,e),this.appEl=t,this.form=this.appEl.querySelector(".source-links-form"),this.form.addEventListener("submit",this._onSourceLinksFormSubmit.bind(this))}return _createClass(e,[{key:"_onSourceLinksFormSubmit",value:function(e){e.preventDefault(),this.urlMap={videoUrl:this.appEl.querySelector("#videoUrl").value,subUrl:this.appEl.querySelector("#subUrl").value,audioUrl:this.appEl.querySelector("#audioUrl").value},this.appEl.querySelector(".initial-page").classList.add("initial-page_hidden"),this.appEl.querySelector(".video-page").classList.remove("video-page_hidden"),this.canvas=new Canvas(this.appEl.querySelector(".canvas")),this.player=new Player(this.appEl.querySelector(".video"),this.urlMap.videoUrl,this.canvas)}}]),e}(),Player=function(){function e(t,a,i){_classCallCheck(this,e),this.playerEl=t,this.videoUrl=a,this.canvas=i,this.videoSourceEl=document.createElement("source"),this.videoSourceEl.setAttribute("src",this.videoUrl),this.playerEl.appendChild(this.videoSourceEl),this.playerEl.addEventListener("play",this._onVideoStartToPlay.bind(this))}return _createClass(e,[{key:"_onVideoStartToPlay",value:function(e){this.videoWidth=this.playerEl.clientWidth,this.videoHeight=this.playerEl.clientHeight,this.canvas.canvasEl.width=this.videoWidth,this.canvas.canvasEl.height=this.videoHeight,this.watchTheVideo()}},{key:"watchTheVideo",value:function(){var e=this;this.playerEl.paused||this.playerEl.ended||(this.paintFrame(),setTimeout(function(){e.watchTheVideo()},0))}},{key:"paintFrame",value:function(){this.canvas.context.drawImage(this.playerEl,0,0,this.videoWidth,this.videoHeight);for(var e=this.canvas.context.getImageData(0,0,this.videoWidth,this.videoHeight),t=e.data.length/4,a=0;a<t;a++){var i=e.data[4*a+0],s=e.data[4*a+1],l=e.data[4*a+2],n=.21*i+.72*s+.07*l;e.data[4*a+0]=n,e.data[4*a+1]=n,e.data[4*a+2]=n}this.canvas.context.putImageData(e,0,0)}}]),e}(),Canvas=function e(t){_classCallCheck(this,e),this.canvasEl=t,this.context=this.canvasEl.getContext("2d")},app=new App(document.querySelector(".app"));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImJ1bmRsZS5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIkFwcCIsImVsIiwidGhpcyIsImFwcEVsIiwiZm9ybSIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX29uU291cmNlTGlua3NGb3JtU3VibWl0IiwiYmluZCIsInZhbHVlIiwiZSIsInByZXZlbnREZWZhdWx0IiwidXJsTWFwIiwidmlkZW9VcmwiLCJzdWJVcmwiLCJhdWRpb1VybCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImNhbnZhcyIsIkNhbnZhcyIsInBsYXllciIsIlBsYXllciIsInBsYXllckVsIiwidmlkZW9Tb3VyY2VFbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwiX29uVmlkZW9TdGFydFRvUGxheSIsInZpZGVvV2lkdGgiLCJjbGllbnRXaWR0aCIsInZpZGVvSGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiY2FudmFzRWwiLCJ3aWR0aCIsImhlaWdodCIsIndhdGNoVGhlVmlkZW8iLCJfdGhpcyIsInBhdXNlZCIsImVuZGVkIiwicGFpbnRGcmFtZSIsInNldFRpbWVvdXQiLCJjb250ZXh0IiwiZHJhd0ltYWdlIiwiZnJhbWUiLCJnZXRJbWFnZURhdGEiLCJkYXRhIiwiciIsImciLCJiIiwiYXZlcmFnZSIsInB1dEltYWdlRGF0YSIsImdldENvbnRleHQiLCJhcHAiXSwibWFw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M0MsRUFBU3dELEVBQU1FLEtBQUsxRCxPQUFTLEVBRXhCRCxFQUFJLEVBQUdBLEVBQUlDLEVBQVFELElBQUssQ0FDaEMsR0FBSTRELEdBQUlILEVBQU1FLEtBQVMsRUFBSjNELEVBQVEsR0FDdkI2RCxFQUFJSixFQUFNRSxLQUFTLEVBQUozRCxFQUFRLEdBQ3ZCOEQsRUFBSUwsRUFBTUUsS0FBUyxFQUFKM0QsRUFBUSxHQUN2QitELEVBQVUsSUFBT0gsRUFBSSxJQUFPQyxFQUFJLElBQU9DLENBQzNDTCxHQUFNRSxLQUFTLEVBQUozRCxFQUFRLEdBQUsrRCxFQUN4Qk4sRUFBTUUsS0FBUyxFQUFKM0QsRUFBUSxHQUFLK0QsRUFDeEJOLEVBQU1FLEtBQVMsRUFBSjNELEVBQVEsR0FBSytELEVBR3pCakQsS0FBS2lCLE9BQU93QixRQUFRUyxhQUFhUCxFQUFPLEVBQUcsT0N5QnJDdkIsS0RyQkZGLE9BQ0wsUUFBQUEsR0FBWW5CLEdBQUlyQixnQkFBQXNCLEtBQUFrQixHQUNmbEIsS0FBS2dDLFNBQVdqQyxFQUNoQkMsS0FBS3lDLFFBQVV6QyxLQUFLZ0MsU0FBU21CLFdBQVcsT0FJcENDLElBQU0sR0FBSXRELEtBQUl5QixTQUFTcEIsY0FBYyIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuY2xhc3MgQXBwIHtcblx0Y29uc3RydWN0b3IoZWwpIHtcblx0XHR0aGlzLmFwcEVsID0gZWw7XG5cdFx0dGhpcy5mb3JtID0gdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuc291cmNlLWxpbmtzLWZvcm0nKTtcblx0XHR0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5fb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQuYmluZCh0aGlzKSk7XG5cdH07XG5cblx0X29uU291cmNlTGlua3NGb3JtU3VibWl0KGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0dGhpcy51cmxNYXAgPSB7XG5cdFx0XHR2aWRlb1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjdmlkZW9VcmwnKS52YWx1ZSxcblx0XHRcdHN1YlVybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjc3ViVXJsJykudmFsdWUsXG5cdFx0XHRhdWRpb1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjYXVkaW9VcmwnKS52YWx1ZSxcblx0XHR9O1xuXHRcdHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLmluaXRpYWwtcGFnZScpLmNsYXNzTGlzdC5hZGQoJ2luaXRpYWwtcGFnZV9oaWRkZW4nKTtcblx0XHR0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1wYWdlJykuY2xhc3NMaXN0LnJlbW92ZSgndmlkZW8tcGFnZV9oaWRkZW4nKTtcblxuXHRcdHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyh0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMnKSk7XG5cdFx0dGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvJyksIHRoaXMudXJsTWFwLnZpZGVvVXJsLCB0aGlzLmNhbnZhcyk7XG5cdH07XG59O1xuXG5jbGFzcyBQbGF5ZXIge1xuXHRjb25zdHJ1Y3RvcihlbCwgdmlkZW9VcmwsIGNhbnZhcykge1xuXHRcdHRoaXMucGxheWVyRWwgPSBlbDtcblx0XHR0aGlzLnZpZGVvVXJsID0gdmlkZW9Vcmw7XG5cdFx0dGhpcy5jYW52YXMgPSBjYW52YXM7XG5cdFx0dGhpcy52aWRlb1NvdXJjZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG5cdFx0dGhpcy52aWRlb1NvdXJjZUVsLnNldEF0dHJpYnV0ZSgnc3JjJywgdGhpcy52aWRlb1VybCk7XG5cdFx0dGhpcy5wbGF5ZXJFbC5hcHBlbmRDaGlsZCh0aGlzLnZpZGVvU291cmNlRWwpO1xuXHRcdHRoaXMucGxheWVyRWwuYWRkRXZlbnRMaXN0ZW5lcigncGxheScsIHRoaXMuX29uVmlkZW9TdGFydFRvUGxheS5iaW5kKHRoaXMpKTtcblx0fTtcblxuXHRfb25WaWRlb1N0YXJ0VG9QbGF5KGUpIHtcblx0XHR0aGlzLnZpZGVvV2lkdGggPSB0aGlzLnBsYXllckVsLmNsaWVudFdpZHRoO1xuXHRcdHRoaXMudmlkZW9IZWlnaHQgPSB0aGlzLnBsYXllckVsLmNsaWVudEhlaWdodDtcblx0XHR0aGlzLmNhbnZhcy5jYW52YXNFbC53aWR0aCA9IHRoaXMudmlkZW9XaWR0aDtcblx0XHR0aGlzLmNhbnZhcy5jYW52YXNFbC5oZWlnaHQgPSB0aGlzLnZpZGVvSGVpZ2h0O1xuXHRcdHRoaXMud2F0Y2hUaGVWaWRlbygpO1xuXHR9O1xuXG5cdHdhdGNoVGhlVmlkZW8oKSB7XG5cdFx0aWYgKHRoaXMucGxheWVyRWwucGF1c2VkIHx8IHRoaXMucGxheWVyRWwuZW5kZWQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXG5cdFx0dGhpcy5wYWludEZyYW1lKCk7XG5cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMud2F0Y2hUaGVWaWRlbygpO1xuXHRcdH0sIDApO1xuXHR9O1xuXG5cdHBhaW50RnJhbWUoKSB7XG5cdFx0dGhpcy5jYW52YXMuY29udGV4dC5kcmF3SW1hZ2UodGhpcy5wbGF5ZXJFbCwgMCwgMCwgdGhpcy52aWRlb1dpZHRoLCB0aGlzLnZpZGVvSGVpZ2h0KTtcblx0XHRsZXQgZnJhbWUgPSB0aGlzLmNhbnZhcy5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLnZpZGVvV2lkdGgsIHRoaXMudmlkZW9IZWlnaHQpO1xuXHRcdGxldCBsZW5ndGggPSBmcmFtZS5kYXRhLmxlbmd0aCAvIDQ7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgciA9IGZyYW1lLmRhdGFbaSAqIDQgKyAwXTtcblx0XHRcdGxldCBnID0gZnJhbWUuZGF0YVtpICogNCArIDFdO1xuXHRcdFx0bGV0IGIgPSBmcmFtZS5kYXRhW2kgKiA0ICsgMl07XG5cdFx0XHRsZXQgYXZlcmFnZSA9IDAuMjEgKiByICsgMC43MiAqIGcgKyAwLjA3ICogYjtcblx0XHRcdGZyYW1lLmRhdGFbaSAqIDQgKyAwXSA9IGF2ZXJhZ2U7XG5cdFx0XHRmcmFtZS5kYXRhW2kgKiA0ICsgMV0gPSBhdmVyYWdlO1xuXHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDJdID0gYXZlcmFnZTtcblx0XHR9O1xuXG5cdFx0dGhpcy5jYW52YXMuY29udGV4dC5wdXRJbWFnZURhdGEoZnJhbWUsIDAsIDApO1xuXHR9O1xufTtcblxuY2xhc3MgQ2FudmFzIHtcblx0Y29uc3RydWN0b3IoZWwpIHtcblx0XHR0aGlzLmNhbnZhc0VsID0gZWw7XG5cdFx0dGhpcy5jb250ZXh0ID0gdGhpcy5jYW52YXNFbC5nZXRDb250ZXh0KFwiMmRcIik7XG5cdH07XG59O1xuXG5jb25zdCBhcHAgPSBuZXcgQXBwKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHAnKSk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBBcHAgPSBmdW5jdGlvbiAoKSB7XG5cdGZ1bmN0aW9uIEFwcChlbCkge1xuXHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBcHApO1xuXG5cdFx0dGhpcy5hcHBFbCA9IGVsO1xuXHRcdHRoaXMuZm9ybSA9IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnNvdXJjZS1saW5rcy1mb3JtJyk7XG5cdFx0dGhpcy5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX29uU291cmNlTGlua3NGb3JtU3VibWl0LmJpbmQodGhpcykpO1xuXHR9XG5cblx0X2NyZWF0ZUNsYXNzKEFwcCwgW3tcblx0XHRrZXk6ICdfb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBfb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQoZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy51cmxNYXAgPSB7XG5cdFx0XHRcdHZpZGVvVXJsOiB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJyN2aWRlb1VybCcpLnZhbHVlLFxuXHRcdFx0XHRzdWJVcmw6IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignI3N1YlVybCcpLnZhbHVlLFxuXHRcdFx0XHRhdWRpb1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjYXVkaW9VcmwnKS52YWx1ZVxuXHRcdFx0fTtcblx0XHRcdHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLmluaXRpYWwtcGFnZScpLmNsYXNzTGlzdC5hZGQoJ2luaXRpYWwtcGFnZV9oaWRkZW4nKTtcblx0XHRcdHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvLXBhZ2UnKS5jbGFzc0xpc3QucmVtb3ZlKCd2aWRlby1wYWdlX2hpZGRlbicpO1xuXG5cdFx0XHR0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXModGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuY2FudmFzJykpO1xuXHRcdFx0dGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvJyksIHRoaXMudXJsTWFwLnZpZGVvVXJsLCB0aGlzLmNhbnZhcyk7XG5cdFx0fVxuXHR9XSk7XG5cblx0cmV0dXJuIEFwcDtcbn0oKTtcblxuO1xuXG52YXIgUGxheWVyID0gZnVuY3Rpb24gKCkge1xuXHRmdW5jdGlvbiBQbGF5ZXIoZWwsIHZpZGVvVXJsLCBjYW52YXMpIHtcblx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGxheWVyKTtcblxuXHRcdHRoaXMucGxheWVyRWwgPSBlbDtcblx0XHR0aGlzLnZpZGVvVXJsID0gdmlkZW9Vcmw7XG5cdFx0dGhpcy5jYW52YXMgPSBjYW52YXM7XG5cdFx0dGhpcy52aWRlb1NvdXJjZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG5cdFx0dGhpcy52aWRlb1NvdXJjZUVsLnNldEF0dHJpYnV0ZSgnc3JjJywgdGhpcy52aWRlb1VybCk7XG5cdFx0dGhpcy5wbGF5ZXJFbC5hcHBlbmRDaGlsZCh0aGlzLnZpZGVvU291cmNlRWwpO1xuXHRcdHRoaXMucGxheWVyRWwuYWRkRXZlbnRMaXN0ZW5lcigncGxheScsIHRoaXMuX29uVmlkZW9TdGFydFRvUGxheS5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdF9jcmVhdGVDbGFzcyhQbGF5ZXIsIFt7XG5cdFx0a2V5OiAnX29uVmlkZW9TdGFydFRvUGxheScsXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIF9vblZpZGVvU3RhcnRUb1BsYXkoZSkge1xuXHRcdFx0dGhpcy52aWRlb1dpZHRoID0gdGhpcy5wbGF5ZXJFbC5jbGllbnRXaWR0aDtcblx0XHRcdHRoaXMudmlkZW9IZWlnaHQgPSB0aGlzLnBsYXllckVsLmNsaWVudEhlaWdodDtcblx0XHRcdHRoaXMuY2FudmFzLmNhbnZhc0VsLndpZHRoID0gdGhpcy52aWRlb1dpZHRoO1xuXHRcdFx0dGhpcy5jYW52YXMuY2FudmFzRWwuaGVpZ2h0ID0gdGhpcy52aWRlb0hlaWdodDtcblx0XHRcdHRoaXMud2F0Y2hUaGVWaWRlbygpO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ3dhdGNoVGhlVmlkZW8nLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiB3YXRjaFRoZVZpZGVvKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdFx0aWYgKHRoaXMucGxheWVyRWwucGF1c2VkIHx8IHRoaXMucGxheWVyRWwuZW5kZWQpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblxuXHRcdFx0dGhpcy5wYWludEZyYW1lKCk7XG5cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRfdGhpcy53YXRjaFRoZVZpZGVvKCk7XG5cdFx0XHR9LCAwKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICdwYWludEZyYW1lJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcGFpbnRGcmFtZSgpIHtcblx0XHRcdHRoaXMuY2FudmFzLmNvbnRleHQuZHJhd0ltYWdlKHRoaXMucGxheWVyRWwsIDAsIDAsIHRoaXMudmlkZW9XaWR0aCwgdGhpcy52aWRlb0hlaWdodCk7XG5cdFx0XHR2YXIgZnJhbWUgPSB0aGlzLmNhbnZhcy5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLnZpZGVvV2lkdGgsIHRoaXMudmlkZW9IZWlnaHQpO1xuXHRcdFx0dmFyIGxlbmd0aCA9IGZyYW1lLmRhdGEubGVuZ3RoIC8gNDtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgciA9IGZyYW1lLmRhdGFbaSAqIDQgKyAwXTtcblx0XHRcdFx0dmFyIGcgPSBmcmFtZS5kYXRhW2kgKiA0ICsgMV07XG5cdFx0XHRcdHZhciBiID0gZnJhbWUuZGF0YVtpICogNCArIDJdO1xuXHRcdFx0XHR2YXIgYXZlcmFnZSA9IDAuMjEgKiByICsgMC43MiAqIGcgKyAwLjA3ICogYjtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDBdID0gYXZlcmFnZTtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDFdID0gYXZlcmFnZTtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDJdID0gYXZlcmFnZTtcblx0XHRcdH07XG5cblx0XHRcdHRoaXMuY2FudmFzLmNvbnRleHQucHV0SW1hZ2VEYXRhKGZyYW1lLCAwLCAwKTtcblx0XHR9XG5cdH1dKTtcblxuXHRyZXR1cm4gUGxheWVyO1xufSgpO1xuXG47XG5cbnZhciBDYW52YXMgPSBmdW5jdGlvbiBDYW52YXMoZWwpIHtcblx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbnZhcyk7XG5cblx0dGhpcy5jYW52YXNFbCA9IGVsO1xuXHR0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKTtcbn07XG5cbjtcblxudmFyIGFwcCA9IG5ldyBBcHAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcCcpKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
