"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),App=function(){function e(t){_classCallCheck(this,e),this.appEl=t,this.form=this.appEl.querySelector(".source-links-form"),this.form.addEventListener("submit",this._onSourceLinksFormSubmit.bind(this))}return _createClass(e,[{key:"_onSourceLinksFormSubmit",value:function(e){e.preventDefault();var t="./assets/video/overlay.mp4";this.overlayCanvas=this.appEl.querySelector(".canvas-overlay"),this.urlMap={videoUrl:this.appEl.querySelector("#videoUrl").value,subsUrl:this.appEl.querySelector("#subUrl").value,audioUrl:this.appEl.querySelector("#audioUrl").value},this.appEl.querySelector(".initial-page").classList.add("initial-page_hidden"),this.appEl.querySelector(".video-page").classList.remove("video-page_hidden"),this.subs=new Subs(this.urlMap),this.player=new Player(this.appEl.querySelector(".video-custom"),this.urlMap.videoUrl,this.subs),this.overlayPlayer=new Player(this.appEl.querySelector(".video-overlay"),t,this.subs),this.audio=new Audio(this.appEl.querySelector(".audio"),this.urlMap.audioUrl),this.canvas=new Canvas(this.appEl.querySelector(".canvas"),this.player,this.overlayPlayer,this.subs,this.overlayCanvas,this.audio)}}]),e}(),Player=function(){function e(t,i,a){_classCallCheck(this,e),this.playerEl=t,this.videoUrl=i,this.isPlaying=!1,this.width=640,this.height=360,this.playerEl.width=this.width,this.playerEl.height=this.height,this.videoSourceEl=document.createElement("source"),this.videoSourceEl.setAttribute("src",this.videoUrl),this.playerEl.appendChild(this.videoSourceEl)}return _createClass(e,[{key:"play",value:function(){this.playerEl.play()}},{key:"pause",value:function(){this.playerEl.pause()}}]),e}(),Canvas=function(){function e(t,i,a,s,r,l){_classCallCheck(this,e),this.canvasEl=t,this.overlayCanvas=r,this.player=i,this.overlayPlayer=a,this.overlayCanvasContext=this.overlayCanvas.getContext("2d"),this.subs=s,this.subsCurrСue=0,this.audio=l,this.context=this.canvasEl.getContext("2d"),this.canvasEl.addEventListener("click",this._onCanvasClick.bind(this)),this.canvasEl.width=this.player.width,this.canvasEl.height=this.player.height,this.context.fillStyle="rgb(0, 0, 0)",this.context.fillRect(0,0,this.canvasEl.width,this.canvasEl.height)}return _createClass(e,[{key:"_onCanvasClick",value:function(e){if(this.player.isPlaying)this.player.pause(),this.overlayPlayer.pause(),this.audio.pause(),clearTimeout(this.t1),clearTimeout(this.t2),cancelAnimationFrame(this.textReq),cancelAnimationFrame(this.videoReq),this.player.isPlaying=!this.player.isPlaying;else{if(this.checkSubsAvailability(e)===!1)return;this.subs.parsedSubs=this.getNeededSubsForThisTime(),this.subsCurrСue=0,this.player.play(),this.overlayPlayer.play(),this.audio.play(),this.startTimeСountup(),cancelAnimationFrame(this.textReq),this.videoReq=requestAnimationFrame(this.watchTheVideo.bind(this)),this.player.isPlaying=!this.player.isPlaying}}},{key:"getNeededSubsForThisTime",value:function(){var e=parseInt(1e3*this.player.playerEl.currentTime),t=this.subs.parsedSubs.filter(function(t){if(t.endTime>=e)return!0});return t}},{key:"resumePlayAfterSubs",value:function(){this.player.play(),this.startTimeСountup(),cancelAnimationFrame(this.textReq),this.videoReq=requestAnimationFrame(this.watchTheVideo.bind(this))}},{key:"startTimeСountup",value:function(){var e=this,t=this.subs.parsedSubs[this.subsCurrСue].endTime-1e3*parseInt(this.player.playerEl.currentTime),i=this.subs.parsedSubs[this.subsCurrСue].endTime-this.subs.parsedSubs[this.subsCurrСue].startTime;this.t1=setTimeout(function(){e.player.pause(),cancelAnimationFrame(e.videoReq),e.textReq=requestAnimationFrame(e.drowText.bind(e)),clearTimeout(e.t1),e.t2=setTimeout(function(){e.subsCurrСue<e.subs.parsedSubs.length-1&&e.subsCurrСue++,e.resumePlayAfterSubs(),clearTimeout(e.t2)},i)},t)}},{key:"watchTheVideo",value:function(){return this.player.playerEl.ended?(console.log("ended"),this.audio.pause(),void this.overlayPlayer.pause()):(this.paintFrame(),cancelAnimationFrame(this.textReq),void(this.videoReq=requestAnimationFrame(this.watchTheVideo.bind(this))))}},{key:"cancelVideoAndAudio",value:function(){}},{key:"paintFrame",value:function(){this.context.drawImage(this.player.playerEl,0,0,this.player.width,this.player.height);for(var e=this.context.getImageData(0,0,this.player.width,this.player.height),t=e.data.length/4,i=0;i<t;i++){var a=e.data[4*i+0],s=e.data[4*i+1],r=e.data[4*i+2],l=.21*a+.72*s+.07*r;e.data[4*i+0]=l,e.data[4*i+1]=l,e.data[4*i+2]=l,e.data[4*i+3]=220}this.context.putImageData(e,0,0),this.paintOverlayEffect()}},{key:"paintOverlayEffect",value:function(){this.overlayCanvasContext.drawImage(this.overlayPlayer.playerEl,0,0,this.overlayPlayer.width,this.overlayPlayer.height);var e=this.overlayCanvasContext.getImageData(0,0,this.canvasEl.width,this.canvasEl.height);this.overlayCanvasContext.putImageData(e,0,0),this.context.globalCompositeOperation="multiply",this.context.drawImage(this.overlayCanvas,0,0,this.canvasEl.width,this.canvasEl.height),this.context.globalCompositeOperation="source-over"}},{key:"drowText",value:function(e){this.context.fillStyle="rgb(50, 50, 50)",this.context.fillRect(0,0,this.canvasEl.width,this.canvasEl.height),this.context.font="36px Oranienbaum",this.context.textAlign="center",this.context.fillStyle="rgb(255, 255, 255)",this.wrapText(this.subs.parsedSubs[this.subsCurrСue].text,this.canvasEl.width,40,this.canvasEl.width/2,this.canvasEl.height/2),this.paintOverlayEffect(),cancelAnimationFrame(this.videoReq),this.textReq=requestAnimationFrame(this.drowText.bind(this))}},{key:"wrapText",value:function(e,t,i,a,s){for(var r=e.split(" "),l="",n=0;n<r.length;n++){var h=l+r[n]+" ",u=this.context.measureText(h).width;u>t-50?(this.context.fillText(l,a,s),l=r[n]+" ",s+=i):l=h}this.context.fillText(l,a,s)}},{key:"checkSubsAvailability",value:function(e){if(!this.subs.ready)return e.preventDefault(),this.player.pause(),this.player.playerEl.currentTime=0,!1}}]),e}(),Subs=function(){function e(t){var i=this;_classCallCheck(this,e),this.ready=!1,fetch(t.subsUrl).then(function(e){e.text().then(function(e){i.parsedSubs=i.parseFromSrt(e),i.ready=!0})})}return _createClass(e,[{key:"parseFromSrt",value:function(e){function t(e,t){var i=t[e].split(":"),a=i[0],s=Number(i[1]),r=i[2].split(","),l=Number(r[0]),n=Number(r[1]);t[e]=36e5*a+6e4*s+1e3*l+n}var i=parser.fromSrt(e);return i.map(function(e){t("endTime",e),t("startTime",e)}),i}}]),e}(),Audio=function(){function e(t,i){_classCallCheck(this,e),this.audioEl=t,this.url=i,this.audioSourceEl=document.createElement("source"),this.audioSourceEl.setAttribute("src",this.url),this.audioEl.appendChild(this.audioSourceEl)}return _createClass(e,[{key:"play",value:function(){this.audioEl.play()}},{key:"pause",value:function(){this.audioEl.pause()}}]),e}(),app=new App(document.querySelector(".app"));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImJ1bmRsZS5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIkFwcCIsImVsIiwidGhpcyIsImFwcEVsIiwiZm9ybSIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX29uU291cmNlTGlua3NGb3JtU3VibWl0IiwiYmluZCIsInZhbHVlIiwiZSIsInByZXZlbnREZWZhdWx0Iiwib3ZlcmxheVZpZGVvVXJsIiwib3ZlcmxheUNhbnZhcyIsInVybE1hcCIsInZpZGVvVXJsIiwic3Vic1VybCIsImF1ZGlvVXJsIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic3VicyIsIlN1YnMiLCJwbGF5ZXIiLCJQbGF5ZXIiLCJvdmVybGF5UGxheWVyIiwiYXVkaW8iLCJBdWRpbyIsImNhbnZhcyIsIkNhbnZhcyIsInVybCIsInBsYXllckVsIiwiaXNQbGF5aW5nIiwid2lkdGgiLCJoZWlnaHQiLCJ2aWRlb1NvdXJjZUVsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJwbGF5IiwicGF1c2UiLCJjYW52YXNFbCIsIm92ZXJsYXlDYW52YXNDb250ZXh0IiwiZ2V0Q29udGV4dCIsInN1YnNDdXJy0KF1ZSIsImNvbnRleHQiLCJfb25DYW52YXNDbGljayIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiY2xlYXJUaW1lb3V0IiwidDEiLCJ0MiIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwidGV4dFJlcSIsInZpZGVvUmVxIiwiY2hlY2tTdWJzQXZhaWxhYmlsaXR5IiwicGFyc2VkU3VicyIsImdldE5lZWRlZFN1YnNGb3JUaGlzVGltZSIsInN0YXJ0VGltZdChb3VudHVwIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwid2F0Y2hUaGVWaWRlbyIsImN1cnJlbnRUaW1lIiwicGFyc2VJbnQiLCJmaWx0ZXJlZFN1YnMiLCJmaWx0ZXIiLCJpdGVtIiwiZW5kVGltZSIsIl90aGlzIiwiZGVsYXlUb1N0YXJ0T2ZTdWJzIiwicGF1c2VEdXJhdGlvbiIsInN0YXJ0VGltZSIsInNldFRpbWVvdXQiLCJkcm93VGV4dCIsInJlc3VtZVBsYXlBZnRlclN1YnMiLCJlbmRlZCIsImNvbnNvbGUiLCJsb2ciLCJwYWludEZyYW1lIiwiZHJhd0ltYWdlIiwiZnJhbWUiLCJnZXRJbWFnZURhdGEiLCJkYXRhIiwiciIsImciLCJiIiwiYXZlcmFnZSIsInB1dEltYWdlRGF0YSIsInBhaW50T3ZlcmxheUVmZmVjdCIsImltYWdlRGF0YSIsImdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiIsInRleHQiLCJmb250IiwidGV4dEFsaWduIiwid3JhcFRleHQiLCJtYXhXaWR0aCIsImxpbmVIZWlnaHQiLCJtYXJnaW5MZWZ0IiwibWFyZ2luVG9wIiwid29yZHMiLCJzcGxpdCIsImxpbmUiLCJ0ZW1wb3JhcnlUZXh0TGluZSIsInRlbXBvcmFyeVRleHRMaW5lV2lkdGgiLCJtZWFzdXJlVGV4dCIsImZpbGxUZXh0IiwicmVhZHkiLCJfdGhpczIiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJwYXJzZUZyb21TcnQiLCJzcnQiLCJ0aW1lUGFyc2VUb01zIiwidGltZVR5cGUiLCJzdWJzU3RhcnRUaW1lQnVmZmVyIiwiaG91cnMiLCJtaW5zIiwiTnVtYmVyIiwic2Vjc0FuZE1zZWNzQnVmZmVyIiwic2VjcyIsIm1zZWNzIiwicGFyc2VyIiwiZnJvbVNydCIsIm1hcCIsImF1ZGlvRWwiLCJhdWRpb1NvdXJjZUVsIiwiYXBwIl0s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RCxHQUFLZ0QsR0FBb0IsS0FBUkUsRUFBeUIsSUFBUEMsRUFBc0IsSUFBUEcsRUFBY0MsRUFiakUsR0FBSWhFLEdBQWFpRSxPQUFPQyxRQUFRWCxFQWVoQyxPQWRBdkQsR0FBV21FLElBQUksU0FBQTFELEdBQ2QrQyxFQUFjLFVBQVcvQyxHQUN6QitDLEVBQWMsWUFBYS9DLEtBWXJCVCxNQ2tERG5DLEtEOUNGSyxNQUFBLFdBQ0wsUUFBQUEsR0FBWTFCLEVBQUk2QixHQUFLbEQsZ0JBQUFzQixLQUFBeUIsR0FDcEJ6QixLQUFLMkgsUUFBVTVILEVBQ2ZDLEtBQUs0QixJQUFNQSxFQUNYNUIsS0FBSzRILGNBQWdCMUYsU0FBU0MsY0FBYyxVQUM1Q25DLEtBQUs0SCxjQUFjeEYsYUFBYSxNQUFPcEMsS0FBSzRCLEtBQzVDNUIsS0FBSzJILFFBQVF0RixZQUFZckMsS0FBSzRILGVDb0UvQixNQVpBOUksY0FBYTJDLElBQ1ovQixJQUFLLE9BQ0xhLE1BQU8sV0R2RFBQLEtBQUsySCxRQUFRckYsVUMyRGI1QyxJQUFLLFFBQ0xhLE1BQU8sV0R6RFBQLEtBQUsySCxRQUFRcEYsWUM4RFBkLEtEMURGb0csSUFBTSxHQUFJL0gsS0FBSW9DLFNBQVMvQixjQUFjIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jbGFzcyBBcHAge1xuXHRjb25zdHJ1Y3RvcihlbCkge1xuXHRcdHRoaXMuYXBwRWwgPSBlbDtcblx0XHR0aGlzLmZvcm0gPSB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5zb3VyY2UtbGlua3MtZm9ybScpO1xuXHRcdHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9vblNvdXJjZUxpbmtzRm9ybVN1Ym1pdC5iaW5kKHRoaXMpKTtcblx0fTtcblxuXHRfb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGxldCBvdmVybGF5VmlkZW9VcmwgPSAnLi9hc3NldHMvdmlkZW8vb3ZlcmxheS5tcDQnO1xuXHRcdHRoaXMub3ZlcmxheUNhbnZhcyA9IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLmNhbnZhcy1vdmVybGF5Jyk7XG5cblx0XHR0aGlzLnVybE1hcCA9IHtcblx0XHRcdHZpZGVvVXJsOiB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJyN2aWRlb1VybCcpLnZhbHVlLFxuXHRcdFx0c3Vic1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjc3ViVXJsJykudmFsdWUsXG5cdFx0XHRhdWRpb1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjYXVkaW9VcmwnKS52YWx1ZSxcblx0XHR9O1xuXG5cdFx0dGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuaW5pdGlhbC1wYWdlJykuY2xhc3NMaXN0LmFkZCgnaW5pdGlhbC1wYWdlX2hpZGRlbicpO1xuXHRcdHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvLXBhZ2UnKS5jbGFzc0xpc3QucmVtb3ZlKCd2aWRlby1wYWdlX2hpZGRlbicpO1xuXG5cdFx0dGhpcy5zdWJzID0gbmV3IFN1YnModGhpcy51cmxNYXApO1xuXHRcdHRoaXMucGxheWVyID0gbmV3IFBsYXllcih0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1jdXN0b20nKSwgdGhpcy51cmxNYXAudmlkZW9VcmwsIHRoaXMuc3Vicyk7XG5cdFx0dGhpcy5vdmVybGF5UGxheWVyID0gbmV3IFBsYXllcih0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1vdmVybGF5JyksIG92ZXJsYXlWaWRlb1VybCwgdGhpcy5zdWJzKTtcblx0XHR0aGlzLmF1ZGlvID0gbmV3IEF1ZGlvKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLmF1ZGlvJyksIHRoaXMudXJsTWFwLmF1ZGlvVXJsKTtcblx0XHR0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXModGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuY2FudmFzJyksIHRoaXMucGxheWVyLCB0aGlzLm92ZXJsYXlQbGF5ZXIsIHRoaXMuc3VicywgdGhpcy5vdmVybGF5Q2FudmFzLCB0aGlzLmF1ZGlvKTtcblx0fTtcbn07XG5cbmNsYXNzIFBsYXllciB7XG5cdGNvbnN0cnVjdG9yKGVsLCB1cmwsIHN1YnMpIHtcblx0XHR0aGlzLnBsYXllckVsID0gZWw7XG5cdFx0dGhpcy52aWRlb1VybCA9IHVybDtcblx0XHR0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuXHRcdHRoaXMud2lkdGggPSA2NDA7XG5cdFx0dGhpcy5oZWlnaHQgPSAzNjA7XG5cdFx0dGhpcy5wbGF5ZXJFbC53aWR0aCA9IHRoaXMud2lkdGg7XG5cdFx0dGhpcy5wbGF5ZXJFbC5oZWlnaHQgPSB0aGlzLmhlaWdodDtcblx0XHR0aGlzLnZpZGVvU291cmNlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcblx0XHR0aGlzLnZpZGVvU291cmNlRWwuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLnZpZGVvVXJsKTtcblx0XHR0aGlzLnBsYXllckVsLmFwcGVuZENoaWxkKHRoaXMudmlkZW9Tb3VyY2VFbCk7XG5cdH07XG5cblx0cGxheSgpIHtcblx0XHR0aGlzLnBsYXllckVsLnBsYXkoKTtcblx0fTtcblxuXHRwYXVzZSgpIHtcblx0XHR0aGlzLnBsYXllckVsLnBhdXNlKCk7XG5cdH07XG59O1xuXG5jbGFzcyBDYW52YXMge1xuXHRjb25zdHJ1Y3RvcihlbCwgcGxheWVyLCBvdmVybGF5UGxheWVyLCBzdWJzLCBvdmVybGF5Q2FudmFzLCBhdWRpbykge1xuXHRcdHRoaXMuY2FudmFzRWwgPSBlbDtcblx0XHR0aGlzLm92ZXJsYXlDYW52YXMgPSBvdmVybGF5Q2FudmFzO1xuXHRcdHRoaXMucGxheWVyID0gcGxheWVyO1xuXHRcdHRoaXMub3ZlcmxheVBsYXllciA9IG92ZXJsYXlQbGF5ZXI7XG5cdFx0dGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dCA9IHRoaXMub3ZlcmxheUNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cdFx0dGhpcy5zdWJzID0gc3Vicztcblx0XHR0aGlzLnN1YnNDdXJy0KF1ZSA9IDA7XG5cdFx0dGhpcy5hdWRpbyA9IGF1ZGlvO1xuXHRcdHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzRWwuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHRcdHRoaXMuY2FudmFzRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNhbnZhc0NsaWNrLmJpbmQodGhpcykpO1xuXHRcdHRoaXMuY2FudmFzRWwud2lkdGggPSB0aGlzLnBsYXllci53aWR0aDtcblx0XHR0aGlzLmNhbnZhc0VsLmhlaWdodCA9IHRoaXMucGxheWVyLmhlaWdodDtcblx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYigwLCAwLCAwKSc7XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0fTtcblxuXHRfb25DYW52YXNDbGljayhlKSB7XG5cdFx0aWYgKHRoaXMucGxheWVyLmlzUGxheWluZykge1xuXHRcdFx0dGhpcy5wbGF5ZXIucGF1c2UoKTtcblx0XHRcdHRoaXMub3ZlcmxheVBsYXllci5wYXVzZSgpO1xuXHRcdFx0dGhpcy5hdWRpby5wYXVzZSgpO1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMudDEpO1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMudDIpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50ZXh0UmVxKTtcblx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudmlkZW9SZXEpO1xuXHRcdFx0dGhpcy5wbGF5ZXIuaXNQbGF5aW5nID0gIXRoaXMucGxheWVyLmlzUGxheWluZztcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRoaXMuY2hlY2tTdWJzQXZhaWxhYmlsaXR5KGUpID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5zdWJzLnBhcnNlZFN1YnMgPSB0aGlzLmdldE5lZWRlZFN1YnNGb3JUaGlzVGltZSgpO1xuXHRcdFx0dGhpcy5zdWJzQ3VyctChdWUgPSAwO1xuXHRcdFx0dGhpcy5wbGF5ZXIucGxheSgpO1xuXHRcdFx0dGhpcy5vdmVybGF5UGxheWVyLnBsYXkoKTtcblx0XHRcdHRoaXMuYXVkaW8ucGxheSgpO1xuXHRcdFx0dGhpcy5zdGFydFRpbWXQoW91bnR1cCgpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50ZXh0UmVxKTtcblx0XHRcdHRoaXMudmlkZW9SZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy53YXRjaFRoZVZpZGVvLmJpbmQodGhpcykpO1xuXHRcdFx0dGhpcy5wbGF5ZXIuaXNQbGF5aW5nID0gIXRoaXMucGxheWVyLmlzUGxheWluZztcblx0XHR9O1xuXHR9O1xuXG5cdGdldE5lZWRlZFN1YnNGb3JUaGlzVGltZSgpIHtcblx0XHRsZXQgY3VycmVudFRpbWUgPSBwYXJzZUludCh0aGlzLnBsYXllci5wbGF5ZXJFbC5jdXJyZW50VGltZSAqIDEwMDApO1xuXHRcdGxldCBmaWx0ZXJlZFN1YnMgPSB0aGlzLnN1YnMucGFyc2VkU3Vicy5maWx0ZXIoaXRlbSA9PiB7XG5cdFx0XHRpZiAoaXRlbS5lbmRUaW1lID49IGN1cnJlbnRUaW1lKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0XHRyZXR1cm4gZmlsdGVyZWRTdWJzO1xuXHR9O1xuXG5cdHJlc3VtZVBsYXlBZnRlclN1YnMoKSB7XG5cdFx0dGhpcy5wbGF5ZXIucGxheSgpO1xuXHRcdHRoaXMuc3RhcnRUaW1l0KFvdW50dXAoKTtcblx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnRleHRSZXEpO1xuXHRcdHRoaXMudmlkZW9SZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy53YXRjaFRoZVZpZGVvLmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdHN0YXJ0VGltZdChb3VudHVwKCkge1xuXHRcdGxldCBkZWxheVRvU3RhcnRPZlN1YnMgPSB0aGlzLnN1YnMucGFyc2VkU3Vic1t0aGlzLnN1YnNDdXJy0KF1ZV0uZW5kVGltZSAtIChwYXJzZUludCh0aGlzLnBsYXllci5wbGF5ZXJFbC5jdXJyZW50VGltZSkgKiAxMDAwKTtcblx0XHRsZXQgcGF1c2VEdXJhdGlvbiA9IHRoaXMuc3Vicy5wYXJzZWRTdWJzW3RoaXMuc3Vic0N1cnLQoXVlXS5lbmRUaW1lIC0gdGhpcy5zdWJzLnBhcnNlZFN1YnNbdGhpcy5zdWJzQ3VyctChdWVdLnN0YXJ0VGltZTtcblx0XHR0aGlzLnQxID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLnBsYXllci5wYXVzZSgpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy52aWRlb1JlcSk7XG5cdFx0XHR0aGlzLnRleHRSZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcm93VGV4dC5iaW5kKHRoaXMpKTtcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnQxKTtcblx0XHRcdHRoaXMudDIgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMuc3Vic0N1cnLQoXVlIDwgKHRoaXMuc3Vicy5wYXJzZWRTdWJzLmxlbmd0aCAtIDEpKSB7XG5cdFx0XHRcdFx0dGhpcy5zdWJzQ3VyctChdWUrKztcblx0XHRcdFx0fTtcblx0XHRcdFx0dGhpcy5yZXN1bWVQbGF5QWZ0ZXJTdWJzKCk7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnQyKTtcblx0XHRcdH0sIHBhdXNlRHVyYXRpb24pO1xuXHRcdH0sIGRlbGF5VG9TdGFydE9mU3Vicyk7XG5cdH07XG5cblx0d2F0Y2hUaGVWaWRlbygpIHtcblx0XHRpZiAodGhpcy5wbGF5ZXIucGxheWVyRWwuZW5kZWQpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdlbmRlZCcpO1xuXHRcdFx0dGhpcy5hdWRpby5wYXVzZSgpO1xuXHRcdFx0dGhpcy5vdmVybGF5UGxheWVyLnBhdXNlKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHR0aGlzLnBhaW50RnJhbWUoKTtcblx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnRleHRSZXEpO1xuXHRcdHRoaXMudmlkZW9SZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy53YXRjaFRoZVZpZGVvLmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdGNhbmNlbFZpZGVvQW5kQXVkaW8oKSB7XG5cblx0fTtcblxuXHRwYWludEZyYW1lKCkge1xuXHRcdHRoaXMuY29udGV4dC5kcmF3SW1hZ2UodGhpcy5wbGF5ZXIucGxheWVyRWwsIDAsIDAsIHRoaXMucGxheWVyLndpZHRoLCB0aGlzLnBsYXllci5oZWlnaHQpO1xuXHRcdGxldCBmcmFtZSA9IHRoaXMuY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5wbGF5ZXIud2lkdGgsIHRoaXMucGxheWVyLmhlaWdodCk7XG5cdFx0bGV0IGxlbmd0aCA9IGZyYW1lLmRhdGEubGVuZ3RoIC8gNDtcblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCByID0gZnJhbWUuZGF0YVtpICogNCArIDBdO1xuXHRcdFx0bGV0IGcgPSBmcmFtZS5kYXRhW2kgKiA0ICsgMV07XG5cdFx0XHRsZXQgYiA9IGZyYW1lLmRhdGFbaSAqIDQgKyAyXTtcblx0XHRcdGxldCBhdmVyYWdlID0gMC4yMSAqIHIgKyAwLjcyICogZyArIDAuMDcgKiBiO1xuXHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDBdID0gYXZlcmFnZTtcblx0XHRcdGZyYW1lLmRhdGFbaSAqIDQgKyAxXSA9IGF2ZXJhZ2U7XG5cdFx0XHRmcmFtZS5kYXRhW2kgKiA0ICsgMl0gPSBhdmVyYWdlO1xuXHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDNdID0gMjIwO1xuXHRcdH07XG5cdFx0dGhpcy5jb250ZXh0LnB1dEltYWdlRGF0YShmcmFtZSwgMCwgMCk7XG5cdFx0dGhpcy5wYWludE92ZXJsYXlFZmZlY3QoKTtcblx0fTtcblxuXHRwYWludE92ZXJsYXlFZmZlY3QoKSB7XG5cdFx0dGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dC5kcmF3SW1hZ2UodGhpcy5vdmVybGF5UGxheWVyLnBsYXllckVsLCAwLCAwLCB0aGlzLm92ZXJsYXlQbGF5ZXIud2lkdGgsIHRoaXMub3ZlcmxheVBsYXllci5oZWlnaHQpO1xuXHRcdGxldCBpbWFnZURhdGEgPSB0aGlzLm92ZXJsYXlDYW52YXNDb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmNhbnZhc0VsLndpZHRoLCB0aGlzLmNhbnZhc0VsLmhlaWdodCk7XG5cdFx0dGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcblx0XHR0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ211bHRpcGx5Jztcblx0XHR0aGlzLmNvbnRleHQuZHJhd0ltYWdlKHRoaXMub3ZlcmxheUNhbnZhcywgMCwgMCwgdGhpcy5jYW52YXNFbC53aWR0aCwgdGhpcy5jYW52YXNFbC5oZWlnaHQpO1xuXHRcdHRoaXMuY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInO1xuXHR9O1xuXG5cdGRyb3dUZXh0KHRleHQpIHtcblx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYig1MCwgNTAsIDUwKSc7XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0XHR0aGlzLmNvbnRleHQuZm9udCA9ICczNnB4IE9yYW5pZW5iYXVtJztcblx0XHR0aGlzLmNvbnRleHQudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcblx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYigyNTUsIDI1NSwgMjU1KSc7XG5cdFx0dGhpcy53cmFwVGV4dCh0aGlzLnN1YnMucGFyc2VkU3Vic1t0aGlzLnN1YnNDdXJy0KF1ZV0udGV4dCwgdGhpcy5jYW52YXNFbC53aWR0aCwgNDAsIHRoaXMuY2FudmFzRWwud2lkdGggLyAyLCB0aGlzLmNhbnZhc0VsLmhlaWdodCAvIDIpO1xuXHRcdHRoaXMucGFpbnRPdmVybGF5RWZmZWN0KCk7XG5cdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy52aWRlb1JlcSk7XG5cdFx0dGhpcy50ZXh0UmVxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuZHJvd1RleHQuYmluZCh0aGlzKSk7XG5cdH07XG5cblx0d3JhcFRleHQodGV4dCwgbWF4V2lkdGgsIGxpbmVIZWlnaHQsIG1hcmdpbkxlZnQsIG1hcmdpblRvcCkge1xuXHRcdGxldCB3b3JkcyA9IHRleHQuc3BsaXQoXCIgXCIpO1xuXHRcdGxldCBsaW5lID0gXCJcIjtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHdvcmRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgdGVtcG9yYXJ5VGV4dExpbmUgPSBsaW5lICsgd29yZHNbaV0gKyBcIiBcIjtcblx0XHRcdGxldCB0ZW1wb3JhcnlUZXh0TGluZVdpZHRoID0gdGhpcy5jb250ZXh0Lm1lYXN1cmVUZXh0KHRlbXBvcmFyeVRleHRMaW5lKS53aWR0aDtcblx0XHRcdGlmICh0ZW1wb3JhcnlUZXh0TGluZVdpZHRoID4gKG1heFdpZHRoIC0gNTApKSB7XG5cdFx0XHRcdHRoaXMuY29udGV4dC5maWxsVGV4dChsaW5lLCBtYXJnaW5MZWZ0LCBtYXJnaW5Ub3ApO1xuXHRcdFx0XHRsaW5lID0gd29yZHNbaV0gKyBcIiBcIjtcblx0XHRcdFx0bWFyZ2luVG9wICs9IGxpbmVIZWlnaHQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRsaW5lID0gdGVtcG9yYXJ5VGV4dExpbmU7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxUZXh0KGxpbmUsIG1hcmdpbkxlZnQsIG1hcmdpblRvcCk7XG5cdH07XG5cblx0Y2hlY2tTdWJzQXZhaWxhYmlsaXR5KGUpIHtcblx0XHRpZiAoIXRoaXMuc3Vicy5yZWFkeSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy5wbGF5ZXIucGF1c2UoKTtcblx0XHRcdHRoaXMucGxheWVyLnBsYXllckVsLmN1cnJlbnRUaW1lID0gMDtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9O1xuXHR9O1xufTtcblxuY2xhc3MgU3VicyB7XG5cdGNvbnN0cnVjdG9yKHVybE1hcCkge1xuXHRcdHRoaXMucmVhZHkgPSBmYWxzZTtcblx0XHRmZXRjaCh1cmxNYXAuc3Vic1VybClcblx0XHRcdC50aGVuKHJlcyA9PiB7XG5cdFx0XHRcdHJlcy50ZXh0KClcblx0XHRcdFx0XHQudGhlbihkYXRhID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGFyc2VkU3VicyA9IHRoaXMucGFyc2VGcm9tU3J0KGRhdGEpO1xuXHRcdFx0XHRcdFx0dGhpcy5yZWFkeSA9IHRydWU7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0fTtcblxuXHRwYXJzZUZyb21TcnQoc3J0KSB7XG5cdFx0bGV0IHBhcnNlZFN1YnMgPSBwYXJzZXIuZnJvbVNydChzcnQpO1xuXHRcdHBhcnNlZFN1YnMubWFwKGl0ZW0gPT4ge1xuXHRcdFx0dGltZVBhcnNlVG9NcygnZW5kVGltZScsIGl0ZW0pO1xuXHRcdFx0dGltZVBhcnNlVG9Ncygnc3RhcnRUaW1lJywgaXRlbSk7XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiB0aW1lUGFyc2VUb01zKHRpbWVUeXBlLCBpdGVtKSB7XG5cdFx0XHRsZXQgc3Vic1N0YXJ0VGltZUJ1ZmZlciA9IGl0ZW1bdGltZVR5cGVdLnNwbGl0KCc6Jyk7XG5cdFx0XHRsZXQgaG91cnMgPSBzdWJzU3RhcnRUaW1lQnVmZmVyWzBdO1xuXHRcdFx0bGV0IG1pbnMgPSBOdW1iZXIoc3Vic1N0YXJ0VGltZUJ1ZmZlclsxXSk7XG5cdFx0XHRsZXQgc2Vjc0FuZE1zZWNzQnVmZmVyID0gc3Vic1N0YXJ0VGltZUJ1ZmZlclsyXS5zcGxpdCgnLCcpO1xuXHRcdFx0bGV0IHNlY3MgPSBOdW1iZXIoc2Vjc0FuZE1zZWNzQnVmZmVyWzBdKTtcblx0XHRcdGxldCBtc2VjcyA9IE51bWJlcihzZWNzQW5kTXNlY3NCdWZmZXJbMV0pO1xuXHRcdFx0aXRlbVt0aW1lVHlwZV0gPSBob3VycyAqIDM2MDAwMDAgKyBtaW5zICogNjAwMDAgKyBzZWNzICogMTAwMCArIG1zZWNzO1xuXHRcdH07XG5cdFx0cmV0dXJuIHBhcnNlZFN1YnM7XG5cdH07XG59O1xuXG5jbGFzcyBBdWRpbyB7XG5cdGNvbnN0cnVjdG9yKGVsLCB1cmwpIHtcblx0XHR0aGlzLmF1ZGlvRWwgPSBlbDtcblx0XHR0aGlzLnVybCA9IHVybDtcblx0XHR0aGlzLmF1ZGlvU291cmNlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcblx0XHR0aGlzLmF1ZGlvU291cmNlRWwuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLnVybCk7XG5cdFx0dGhpcy5hdWRpb0VsLmFwcGVuZENoaWxkKHRoaXMuYXVkaW9Tb3VyY2VFbCk7XG5cdH07XG5cdHBsYXkoKSB7XG5cdFx0dGhpcy5hdWRpb0VsLnBsYXkoKTtcblx0fTtcblx0cGF1c2UoKSB7XG5cdFx0dGhpcy5hdWRpb0VsLnBhdXNlKCk7XG5cdH07XG59O1xuXG5jb25zdCBhcHAgPSBuZXcgQXBwKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hcHAnKSk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBBcHAgPSBmdW5jdGlvbiAoKSB7XG5cdGZ1bmN0aW9uIEFwcChlbCkge1xuXHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBcHApO1xuXG5cdFx0dGhpcy5hcHBFbCA9IGVsO1xuXHRcdHRoaXMuZm9ybSA9IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnNvdXJjZS1saW5rcy1mb3JtJyk7XG5cdFx0dGhpcy5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX29uU291cmNlTGlua3NGb3JtU3VibWl0LmJpbmQodGhpcykpO1xuXHR9XG5cblx0X2NyZWF0ZUNsYXNzKEFwcCwgW3tcblx0XHRrZXk6ICdfb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBfb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQoZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHR2YXIgb3ZlcmxheVZpZGVvVXJsID0gJy4vYXNzZXRzL3ZpZGVvL292ZXJsYXkubXA0Jztcblx0XHRcdHRoaXMub3ZlcmxheUNhbnZhcyA9IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLmNhbnZhcy1vdmVybGF5Jyk7XG5cblx0XHRcdHRoaXMudXJsTWFwID0ge1xuXHRcdFx0XHR2aWRlb1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjdmlkZW9VcmwnKS52YWx1ZSxcblx0XHRcdFx0c3Vic1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjc3ViVXJsJykudmFsdWUsXG5cdFx0XHRcdGF1ZGlvVXJsOiB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJyNhdWRpb1VybCcpLnZhbHVlXG5cdFx0XHR9O1xuXG5cdFx0XHR0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5pbml0aWFsLXBhZ2UnKS5jbGFzc0xpc3QuYWRkKCdpbml0aWFsLXBhZ2VfaGlkZGVuJyk7XG5cdFx0XHR0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1wYWdlJykuY2xhc3NMaXN0LnJlbW92ZSgndmlkZW8tcGFnZV9oaWRkZW4nKTtcblxuXHRcdFx0dGhpcy5zdWJzID0gbmV3IFN1YnModGhpcy51cmxNYXApO1xuXHRcdFx0dGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvLWN1c3RvbScpLCB0aGlzLnVybE1hcC52aWRlb1VybCwgdGhpcy5zdWJzKTtcblx0XHRcdHRoaXMub3ZlcmxheVBsYXllciA9IG5ldyBQbGF5ZXIodGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tb3ZlcmxheScpLCBvdmVybGF5VmlkZW9VcmwsIHRoaXMuc3Vicyk7XG5cdFx0XHR0aGlzLmF1ZGlvID0gbmV3IEF1ZGlvKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLmF1ZGlvJyksIHRoaXMudXJsTWFwLmF1ZGlvVXJsKTtcblx0XHRcdHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyh0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMnKSwgdGhpcy5wbGF5ZXIsIHRoaXMub3ZlcmxheVBsYXllciwgdGhpcy5zdWJzLCB0aGlzLm92ZXJsYXlDYW52YXMsIHRoaXMuYXVkaW8pO1xuXHRcdH1cblx0fV0pO1xuXG5cdHJldHVybiBBcHA7XG59KCk7XG5cbjtcblxudmFyIFBsYXllciA9IGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gUGxheWVyKGVsLCB1cmwsIHN1YnMpIHtcblx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGxheWVyKTtcblxuXHRcdHRoaXMucGxheWVyRWwgPSBlbDtcblx0XHR0aGlzLnZpZGVvVXJsID0gdXJsO1xuXHRcdHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG5cdFx0dGhpcy53aWR0aCA9IDY0MDtcblx0XHR0aGlzLmhlaWdodCA9IDM2MDtcblx0XHR0aGlzLnBsYXllckVsLndpZHRoID0gdGhpcy53aWR0aDtcblx0XHR0aGlzLnBsYXllckVsLmhlaWdodCA9IHRoaXMuaGVpZ2h0O1xuXHRcdHRoaXMudmlkZW9Tb3VyY2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuXHRcdHRoaXMudmlkZW9Tb3VyY2VFbC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMudmlkZW9VcmwpO1xuXHRcdHRoaXMucGxheWVyRWwuYXBwZW5kQ2hpbGQodGhpcy52aWRlb1NvdXJjZUVsKTtcblx0fVxuXG5cdF9jcmVhdGVDbGFzcyhQbGF5ZXIsIFt7XG5cdFx0a2V5OiAncGxheScsXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHBsYXkoKSB7XG5cdFx0XHR0aGlzLnBsYXllckVsLnBsYXkoKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICdwYXVzZScsXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkge1xuXHRcdFx0dGhpcy5wbGF5ZXJFbC5wYXVzZSgpO1xuXHRcdH1cblx0fV0pO1xuXG5cdHJldHVybiBQbGF5ZXI7XG59KCk7XG5cbjtcblxudmFyIENhbnZhcyA9IGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gQ2FudmFzKGVsLCBwbGF5ZXIsIG92ZXJsYXlQbGF5ZXIsIHN1YnMsIG92ZXJsYXlDYW52YXMsIGF1ZGlvKSB7XG5cdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbnZhcyk7XG5cblx0XHR0aGlzLmNhbnZhc0VsID0gZWw7XG5cdFx0dGhpcy5vdmVybGF5Q2FudmFzID0gb3ZlcmxheUNhbnZhcztcblx0XHR0aGlzLnBsYXllciA9IHBsYXllcjtcblx0XHR0aGlzLm92ZXJsYXlQbGF5ZXIgPSBvdmVybGF5UGxheWVyO1xuXHRcdHRoaXMub3ZlcmxheUNhbnZhc0NvbnRleHQgPSB0aGlzLm92ZXJsYXlDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHRcdHRoaXMuc3VicyA9IHN1YnM7XG5cdFx0dGhpcy5zdWJzQ3VyctChdWUgPSAwO1xuXHRcdHRoaXMuYXVkaW8gPSBhdWRpbztcblx0XHR0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKTtcblx0XHR0aGlzLmNhbnZhc0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DYW52YXNDbGljay5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLmNhbnZhc0VsLndpZHRoID0gdGhpcy5wbGF5ZXIud2lkdGg7XG5cdFx0dGhpcy5jYW52YXNFbC5oZWlnaHQgPSB0aGlzLnBsYXllci5oZWlnaHQ7XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICdyZ2IoMCwgMCwgMCknO1xuXHRcdHRoaXMuY29udGV4dC5maWxsUmVjdCgwLCAwLCB0aGlzLmNhbnZhc0VsLndpZHRoLCB0aGlzLmNhbnZhc0VsLmhlaWdodCk7XG5cdH1cblxuXHRfY3JlYXRlQ2xhc3MoQ2FudmFzLCBbe1xuXHRcdGtleTogJ19vbkNhbnZhc0NsaWNrJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gX29uQ2FudmFzQ2xpY2soZSkge1xuXHRcdFx0aWYgKHRoaXMucGxheWVyLmlzUGxheWluZykge1xuXHRcdFx0XHR0aGlzLnBsYXllci5wYXVzZSgpO1xuXHRcdFx0XHR0aGlzLm92ZXJsYXlQbGF5ZXIucGF1c2UoKTtcblx0XHRcdFx0dGhpcy5hdWRpby5wYXVzZSgpO1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy50MSk7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnQyKTtcblx0XHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50ZXh0UmVxKTtcblx0XHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy52aWRlb1JlcSk7XG5cdFx0XHRcdHRoaXMucGxheWVyLmlzUGxheWluZyA9ICF0aGlzLnBsYXllci5pc1BsYXlpbmc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodGhpcy5jaGVja1N1YnNBdmFpbGFiaWxpdHkoZSkgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHR0aGlzLnN1YnMucGFyc2VkU3VicyA9IHRoaXMuZ2V0TmVlZGVkU3Vic0ZvclRoaXNUaW1lKCk7XG5cdFx0XHRcdHRoaXMuc3Vic0N1cnLQoXVlID0gMDtcblx0XHRcdFx0dGhpcy5wbGF5ZXIucGxheSgpO1xuXHRcdFx0XHR0aGlzLm92ZXJsYXlQbGF5ZXIucGxheSgpO1xuXHRcdFx0XHR0aGlzLmF1ZGlvLnBsYXkoKTtcblx0XHRcdFx0dGhpcy5zdGFydFRpbWXQoW91bnR1cCgpO1xuXHRcdFx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnRleHRSZXEpO1xuXHRcdFx0XHR0aGlzLnZpZGVvUmVxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMud2F0Y2hUaGVWaWRlby5iaW5kKHRoaXMpKTtcblx0XHRcdFx0dGhpcy5wbGF5ZXIuaXNQbGF5aW5nID0gIXRoaXMucGxheWVyLmlzUGxheWluZztcblx0XHRcdH07XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAnZ2V0TmVlZGVkU3Vic0ZvclRoaXNUaW1lJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gZ2V0TmVlZGVkU3Vic0ZvclRoaXNUaW1lKCkge1xuXHRcdFx0dmFyIGN1cnJlbnRUaW1lID0gcGFyc2VJbnQodGhpcy5wbGF5ZXIucGxheWVyRWwuY3VycmVudFRpbWUgKiAxMDAwKTtcblx0XHRcdHZhciBmaWx0ZXJlZFN1YnMgPSB0aGlzLnN1YnMucGFyc2VkU3Vicy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0aWYgKGl0ZW0uZW5kVGltZSA+PSBjdXJyZW50VGltZSkge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZmlsdGVyZWRTdWJzO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ3Jlc3VtZVBsYXlBZnRlclN1YnMnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiByZXN1bWVQbGF5QWZ0ZXJTdWJzKCkge1xuXHRcdFx0dGhpcy5wbGF5ZXIucGxheSgpO1xuXHRcdFx0dGhpcy5zdGFydFRpbWXQoW91bnR1cCgpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50ZXh0UmVxKTtcblx0XHRcdHRoaXMudmlkZW9SZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy53YXRjaFRoZVZpZGVvLmJpbmQodGhpcykpO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ3N0YXJ0VGltZdChb3VudHVwJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gc3RhcnRUaW1lT3VudHVwKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdFx0dmFyIGRlbGF5VG9TdGFydE9mU3VicyA9IHRoaXMuc3Vicy5wYXJzZWRTdWJzW3RoaXMuc3Vic0N1cnLQoXVlXS5lbmRUaW1lIC0gcGFyc2VJbnQodGhpcy5wbGF5ZXIucGxheWVyRWwuY3VycmVudFRpbWUpICogMTAwMDtcblx0XHRcdHZhciBwYXVzZUR1cmF0aW9uID0gdGhpcy5zdWJzLnBhcnNlZFN1YnNbdGhpcy5zdWJzQ3VyctChdWVdLmVuZFRpbWUgLSB0aGlzLnN1YnMucGFyc2VkU3Vic1t0aGlzLnN1YnNDdXJy0KF1ZV0uc3RhcnRUaW1lO1xuXHRcdFx0dGhpcy50MSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRfdGhpcy5wbGF5ZXIucGF1c2UoKTtcblx0XHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUoX3RoaXMudmlkZW9SZXEpO1xuXHRcdFx0XHRfdGhpcy50ZXh0UmVxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKF90aGlzLmRyb3dUZXh0LmJpbmQoX3RoaXMpKTtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KF90aGlzLnQxKTtcblx0XHRcdFx0X3RoaXMudDIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRpZiAoX3RoaXMuc3Vic0N1cnLQoXVlIDwgX3RoaXMuc3Vicy5wYXJzZWRTdWJzLmxlbmd0aCAtIDEpIHtcblx0XHRcdFx0XHRcdF90aGlzLnN1YnNDdXJy0KF1ZSsrO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0X3RoaXMucmVzdW1lUGxheUFmdGVyU3VicygpO1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dChfdGhpcy50Mik7XG5cdFx0XHRcdH0sIHBhdXNlRHVyYXRpb24pO1xuXHRcdFx0fSwgZGVsYXlUb1N0YXJ0T2ZTdWJzKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICd3YXRjaFRoZVZpZGVvJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gd2F0Y2hUaGVWaWRlbygpIHtcblx0XHRcdGlmICh0aGlzLnBsYXllci5wbGF5ZXJFbC5lbmRlZCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZygnZW5kZWQnKTtcblx0XHRcdFx0dGhpcy5hdWRpby5wYXVzZSgpO1xuXHRcdFx0XHR0aGlzLm92ZXJsYXlQbGF5ZXIucGF1c2UoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblx0XHRcdHRoaXMucGFpbnRGcmFtZSgpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50ZXh0UmVxKTtcblx0XHRcdHRoaXMudmlkZW9SZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy53YXRjaFRoZVZpZGVvLmJpbmQodGhpcykpO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ2NhbmNlbFZpZGVvQW5kQXVkaW8nLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBjYW5jZWxWaWRlb0FuZEF1ZGlvKCkge31cblx0fSwge1xuXHRcdGtleTogJ3BhaW50RnJhbWUnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBwYWludEZyYW1lKCkge1xuXHRcdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZSh0aGlzLnBsYXllci5wbGF5ZXJFbCwgMCwgMCwgdGhpcy5wbGF5ZXIud2lkdGgsIHRoaXMucGxheWVyLmhlaWdodCk7XG5cdFx0XHR2YXIgZnJhbWUgPSB0aGlzLmNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMucGxheWVyLndpZHRoLCB0aGlzLnBsYXllci5oZWlnaHQpO1xuXHRcdFx0dmFyIGxlbmd0aCA9IGZyYW1lLmRhdGEubGVuZ3RoIC8gNDtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgciA9IGZyYW1lLmRhdGFbaSAqIDQgKyAwXTtcblx0XHRcdFx0dmFyIGcgPSBmcmFtZS5kYXRhW2kgKiA0ICsgMV07XG5cdFx0XHRcdHZhciBiID0gZnJhbWUuZGF0YVtpICogNCArIDJdO1xuXHRcdFx0XHR2YXIgYXZlcmFnZSA9IDAuMjEgKiByICsgMC43MiAqIGcgKyAwLjA3ICogYjtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDBdID0gYXZlcmFnZTtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDFdID0gYXZlcmFnZTtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDJdID0gYXZlcmFnZTtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDNdID0gMjIwO1xuXHRcdFx0fTtcblx0XHRcdHRoaXMuY29udGV4dC5wdXRJbWFnZURhdGEoZnJhbWUsIDAsIDApO1xuXHRcdFx0dGhpcy5wYWludE92ZXJsYXlFZmZlY3QoKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICdwYWludE92ZXJsYXlFZmZlY3QnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBwYWludE92ZXJsYXlFZmZlY3QoKSB7XG5cdFx0XHR0aGlzLm92ZXJsYXlDYW52YXNDb250ZXh0LmRyYXdJbWFnZSh0aGlzLm92ZXJsYXlQbGF5ZXIucGxheWVyRWwsIDAsIDAsIHRoaXMub3ZlcmxheVBsYXllci53aWR0aCwgdGhpcy5vdmVybGF5UGxheWVyLmhlaWdodCk7XG5cdFx0XHR2YXIgaW1hZ2VEYXRhID0gdGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5jYW52YXNFbC53aWR0aCwgdGhpcy5jYW52YXNFbC5oZWlnaHQpO1xuXHRcdFx0dGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcblx0XHRcdHRoaXMuY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnbXVsdGlwbHknO1xuXHRcdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZSh0aGlzLm92ZXJsYXlDYW52YXMsIDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0XHRcdHRoaXMuY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ2Ryb3dUZXh0Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gZHJvd1RleHQodGV4dCkge1xuXHRcdFx0dGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICdyZ2IoNTAsIDUwLCA1MCknO1xuXHRcdFx0dGhpcy5jb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0XHRcdHRoaXMuY29udGV4dC5mb250ID0gJzM2cHggT3JhbmllbmJhdW0nO1xuXHRcdFx0dGhpcy5jb250ZXh0LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XG5cdFx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYigyNTUsIDI1NSwgMjU1KSc7XG5cdFx0XHR0aGlzLndyYXBUZXh0KHRoaXMuc3Vicy5wYXJzZWRTdWJzW3RoaXMuc3Vic0N1cnLQoXVlXS50ZXh0LCB0aGlzLmNhbnZhc0VsLndpZHRoLCA0MCwgdGhpcy5jYW52YXNFbC53aWR0aCAvIDIsIHRoaXMuY2FudmFzRWwuaGVpZ2h0IC8gMik7XG5cdFx0XHR0aGlzLnBhaW50T3ZlcmxheUVmZmVjdCgpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy52aWRlb1JlcSk7XG5cdFx0XHR0aGlzLnRleHRSZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcm93VGV4dC5iaW5kKHRoaXMpKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICd3cmFwVGV4dCcsXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHdyYXBUZXh0KHRleHQsIG1heFdpZHRoLCBsaW5lSGVpZ2h0LCBtYXJnaW5MZWZ0LCBtYXJnaW5Ub3ApIHtcblx0XHRcdHZhciB3b3JkcyA9IHRleHQuc3BsaXQoXCIgXCIpO1xuXHRcdFx0dmFyIGxpbmUgPSBcIlwiO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgdGVtcG9yYXJ5VGV4dExpbmUgPSBsaW5lICsgd29yZHNbaV0gKyBcIiBcIjtcblx0XHRcdFx0dmFyIHRlbXBvcmFyeVRleHRMaW5lV2lkdGggPSB0aGlzLmNvbnRleHQubWVhc3VyZVRleHQodGVtcG9yYXJ5VGV4dExpbmUpLndpZHRoO1xuXHRcdFx0XHRpZiAodGVtcG9yYXJ5VGV4dExpbmVXaWR0aCA+IG1heFdpZHRoIC0gNTApIHtcblx0XHRcdFx0XHR0aGlzLmNvbnRleHQuZmlsbFRleHQobGluZSwgbWFyZ2luTGVmdCwgbWFyZ2luVG9wKTtcblx0XHRcdFx0XHRsaW5lID0gd29yZHNbaV0gKyBcIiBcIjtcblx0XHRcdFx0XHRtYXJnaW5Ub3AgKz0gbGluZUhlaWdodDtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRsaW5lID0gdGVtcG9yYXJ5VGV4dExpbmU7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5jb250ZXh0LmZpbGxUZXh0KGxpbmUsIG1hcmdpbkxlZnQsIG1hcmdpblRvcCk7XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAnY2hlY2tTdWJzQXZhaWxhYmlsaXR5Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gY2hlY2tTdWJzQXZhaWxhYmlsaXR5KGUpIHtcblx0XHRcdGlmICghdGhpcy5zdWJzLnJlYWR5KSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5wbGF5ZXIucGF1c2UoKTtcblx0XHRcdFx0dGhpcy5wbGF5ZXIucGxheWVyRWwuY3VycmVudFRpbWUgPSAwO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9O1xuXHRcdH1cblx0fV0pO1xuXG5cdHJldHVybiBDYW52YXM7XG59KCk7XG5cbjtcblxudmFyIFN1YnMgPSBmdW5jdGlvbiAoKSB7XG5cdGZ1bmN0aW9uIFN1YnModXJsTWFwKSB7XG5cdFx0dmFyIF90aGlzMiA9IHRoaXM7XG5cblx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3Vicyk7XG5cblx0XHR0aGlzLnJlYWR5ID0gZmFsc2U7XG5cdFx0ZmV0Y2godXJsTWFwLnN1YnNVcmwpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuXHRcdFx0cmVzLnRleHQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdF90aGlzMi5wYXJzZWRTdWJzID0gX3RoaXMyLnBhcnNlRnJvbVNydChkYXRhKTtcblx0XHRcdFx0X3RoaXMyLnJlYWR5ID0gdHJ1ZTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0X2NyZWF0ZUNsYXNzKFN1YnMsIFt7XG5cdFx0a2V5OiAncGFyc2VGcm9tU3J0Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcGFyc2VGcm9tU3J0KHNydCkge1xuXHRcdFx0dmFyIHBhcnNlZFN1YnMgPSBwYXJzZXIuZnJvbVNydChzcnQpO1xuXHRcdFx0cGFyc2VkU3Vicy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0dGltZVBhcnNlVG9NcygnZW5kVGltZScsIGl0ZW0pO1xuXHRcdFx0XHR0aW1lUGFyc2VUb01zKCdzdGFydFRpbWUnLCBpdGVtKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRmdW5jdGlvbiB0aW1lUGFyc2VUb01zKHRpbWVUeXBlLCBpdGVtKSB7XG5cdFx0XHRcdHZhciBzdWJzU3RhcnRUaW1lQnVmZmVyID0gaXRlbVt0aW1lVHlwZV0uc3BsaXQoJzonKTtcblx0XHRcdFx0dmFyIGhvdXJzID0gc3Vic1N0YXJ0VGltZUJ1ZmZlclswXTtcblx0XHRcdFx0dmFyIG1pbnMgPSBOdW1iZXIoc3Vic1N0YXJ0VGltZUJ1ZmZlclsxXSk7XG5cdFx0XHRcdHZhciBzZWNzQW5kTXNlY3NCdWZmZXIgPSBzdWJzU3RhcnRUaW1lQnVmZmVyWzJdLnNwbGl0KCcsJyk7XG5cdFx0XHRcdHZhciBzZWNzID0gTnVtYmVyKHNlY3NBbmRNc2Vjc0J1ZmZlclswXSk7XG5cdFx0XHRcdHZhciBtc2VjcyA9IE51bWJlcihzZWNzQW5kTXNlY3NCdWZmZXJbMV0pO1xuXHRcdFx0XHRpdGVtW3RpbWVUeXBlXSA9IGhvdXJzICogMzYwMDAwMCArIG1pbnMgKiA2MDAwMCArIHNlY3MgKiAxMDAwICsgbXNlY3M7XG5cdFx0XHR9O1xuXHRcdFx0cmV0dXJuIHBhcnNlZFN1YnM7XG5cdFx0fVxuXHR9XSk7XG5cblx0cmV0dXJuIFN1YnM7XG59KCk7XG5cbjtcblxudmFyIEF1ZGlvID0gZnVuY3Rpb24gKCkge1xuXHRmdW5jdGlvbiBBdWRpbyhlbCwgdXJsKSB7XG5cdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1ZGlvKTtcblxuXHRcdHRoaXMuYXVkaW9FbCA9IGVsO1xuXHRcdHRoaXMudXJsID0gdXJsO1xuXHRcdHRoaXMuYXVkaW9Tb3VyY2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuXHRcdHRoaXMuYXVkaW9Tb3VyY2VFbC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMudXJsKTtcblx0XHR0aGlzLmF1ZGlvRWwuYXBwZW5kQ2hpbGQodGhpcy5hdWRpb1NvdXJjZUVsKTtcblx0fVxuXG5cdF9jcmVhdGVDbGFzcyhBdWRpbywgW3tcblx0XHRrZXk6ICdwbGF5Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcGxheSgpIHtcblx0XHRcdHRoaXMuYXVkaW9FbC5wbGF5KCk7XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAncGF1c2UnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcblx0XHRcdHRoaXMuYXVkaW9FbC5wYXVzZSgpO1xuXHRcdH1cblx0fV0pO1xuXG5cdHJldHVybiBBdWRpbztcbn0oKTtcblxuO1xuXG52YXIgYXBwID0gbmV3IEFwcChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwJykpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
