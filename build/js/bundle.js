"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),App=function(){function e(t){_classCallCheck(this,e),this.appEl=t,this.form=this.appEl.querySelector(".source-links-form"),this.form.addEventListener("submit",this._onSourceLinksFormSubmit.bind(this))}return _createClass(e,[{key:"_onSourceLinksFormSubmit",value:function(e){e.preventDefault(),this.urlMap={videoUrl:this.appEl.querySelector("#videoUrl").value,subUrl:this.appEl.querySelector("#subUrl").value,audioUrl:this.appEl.querySelector("#audioUrl").value},this.appEl.querySelector(".initial-page").classList.add("initial-page_hidden"),this.appEl.querySelector(".video-page").classList.remove("video-page_hidden"),this.canvas=new Canvas(this.appEl.querySelector(".canvas")),this.player=new Player(this.appEl.querySelector(".video"),this.urlMap.videoUrl,this.canvas)}}]),e}(),Player=function(){function e(t,a,i){_classCallCheck(this,e),this.playerEl=t,this.videoUrl=a,this.canvas=i,this.videoSourceEl=document.createElement("source"),this.videoSourceEl.setAttribute("src",this.videoUrl),this.playerEl.appendChild(this.videoSourceEl),this.playerEl.addEventListener("play",this._onVideoStartToPlay.bind(this))}return _createClass(e,[{key:"_onVideoStartToPlay",value:function(e){this.videoWidth=this.playerEl.videoWidth,this.videoHeight=this.playerEl.videoHeight,this.watchTheVideo()}},{key:"watchTheVideo",value:function(){var e=this;this.playerEl.paused||this.playerEl.ended||(this.paintFrame(),setTimeout(function(){e.watchTheVideo()},0))}},{key:"paintFrame",value:function(){this.canvas.context.drawImage(this.playerEl,0,0,this.videoWidth,this.videoHeight);for(var e=this.canvas.context.getImageData(0,0,this.videoWidth,this.videoHeight),t=e.data.length/4,a=0;a<t;a++){var i=e.data[4*a+0],s=e.data[4*a+1],l=e.data[4*a+2],r=.21*i+.72*s+.07*l;e.data[4*a+0]=r,e.data[4*a+1]=r,e.data[4*a+2]=r}this.canvas.context.putImageData(e,0,0)}}]),e}(),Canvas=function e(t){_classCallCheck(this,e),this.canvasEl=t,this.context=this.canvasEl.getContext("2d")},app=new App(document.querySelector(".app"));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImJ1bmRsZS5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIkFwcCIsImVsIiwidGhpcyIsImFwcEVsIiwiZm9ybSIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX29uU291cmNlTGlua3NGb3JtU3VibWl0IiwiYmluZCIsInZhbHVlIiwiZSIsInByZXZlbnREZWZhdWx0IiwidXJsTWFwIiwidmlkZW9VcmwiLCJzdWJVcmwiLCJhdWRpb1VybCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImNhbnZhcyIsIkNhbnZhcyIsInBsYXllciIsIlBsYXllciIsInBsYXllckVsIiwidmlkZW9Tb3VyY2VFbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwiX29uVmlkZW9TdGFydFRvUGxheSIsInZpZGVvV2lkdGgiLCJ2aWRlb0hlaWdodCIsIndhdGNoVGhlVmlkZW8iLCJfdGhpcyIsInBhdXNlZCIsImVuZGVkIiwicGFpbnRGcmFtZSIsInNldFRpbWVvdXQiLCJjb250ZXh0IiwiZHJhd0ltYWdlIiwiZnJhbWUiLCJnZXRJbWFnZURhdGEiLCJkYXRhIiwiciIsImciLCJiIiwiYXZlcmFnZSIsInB1dEltYWdlRGF0YSIsImNhbnZhc0VsIiwiZ2V0Q29udGV4dCIsImFwcCJdLCJtYXBwaW5ncyI6IkFBQUEsWUNJQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FB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RUFBSnRELEVBQVEsR0FDdkJ5RCxFQUFJTCxFQUFNRSxLQUFTLEVBQUp0RCxFQUFRLEdBQ3ZCMEQsRUFBVSxJQUFPSCxFQUFJLElBQU9DLEVBQUksSUFBT0MsQ0FDM0NMLEdBQU1FLEtBQVMsRUFBSnRELEVBQVEsR0FBSzBELEVBQ3hCTixFQUFNRSxLQUFTLEVBQUp0RCxFQUFRLEdBQUswRCxFQUN4Qk4sRUFBTUUsS0FBUyxFQUFKdEQsRUFBUSxHQUFLMEQsRUFHekI1QyxLQUFLaUIsT0FBT21CLFFBQVFTLGFBQWFQLEVBQU8sRUFBRyxPQzJDckNsQixLRHBCRkYsT0FDTCxRQUFBQSxHQUFZbkIsR0FBSXJCLGdCQUFBc0IsS0FBQWtCLEdBQ2ZsQixLQUFLOEMsU0FBVy9DLEVBQ2hCQyxLQUFLb0MsUUFBVXBDLEtBQUs4QyxTQUFTQyxXQUFXLE9BSXBDQyxJQUFNLEdBQUlsRCxLQUFJeUIsU0FBU3BCLGNBQWMiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNsYXNzIEFwcCB7XG5cdGNvbnN0cnVjdG9yKGVsKSB7XG5cdFx0dGhpcy5hcHBFbCA9IGVsO1xuXHRcdHRoaXMuZm9ybSA9IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnNvdXJjZS1saW5rcy1mb3JtJyk7XG5cdFx0dGhpcy5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX29uU291cmNlTGlua3NGb3JtU3VibWl0LmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdF9vblNvdXJjZUxpbmtzRm9ybVN1Ym1pdChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHRoaXMudXJsTWFwID0ge1xuXHRcdFx0dmlkZW9Vcmw6IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignI3ZpZGVvVXJsJykudmFsdWUsXG5cdFx0XHRzdWJVcmw6IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignI3N1YlVybCcpLnZhbHVlLFxuXHRcdFx0YXVkaW9Vcmw6IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignI2F1ZGlvVXJsJykudmFsdWUsXG5cdFx0fTtcblx0XHR0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5pbml0aWFsLXBhZ2UnKS5jbGFzc0xpc3QuYWRkKCdpbml0aWFsLXBhZ2VfaGlkZGVuJyk7XG5cdFx0dGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tcGFnZScpLmNsYXNzTGlzdC5yZW1vdmUoJ3ZpZGVvLXBhZ2VfaGlkZGVuJyk7XG5cblx0XHR0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXModGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuY2FudmFzJykpO1xuXHRcdHRoaXMucGxheWVyID0gbmV3IFBsYXllcih0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlbycpLCB0aGlzLnVybE1hcC52aWRlb1VybCwgdGhpcy5jYW52YXMpO1xuXHR9O1xufTtcblxuY2xhc3MgUGxheWVyIHtcblx0Y29uc3RydWN0b3IoZWwsIHZpZGVvVXJsLCBjYW52YXMpIHtcblx0XHR0aGlzLnBsYXllckVsID0gZWw7XG5cdFx0dGhpcy52aWRlb1VybCA9IHZpZGVvVXJsO1xuXHRcdHRoaXMuY2FudmFzID0gY2FudmFzO1xuXHRcdHRoaXMudmlkZW9Tb3VyY2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuXHRcdHRoaXMudmlkZW9Tb3VyY2VFbC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMudmlkZW9VcmwpO1xuXHRcdHRoaXMucGxheWVyRWwuYXBwZW5kQ2hpbGQodGhpcy52aWRlb1NvdXJjZUVsKTtcblx0XHR0aGlzLnBsYXllckVsLmFkZEV2ZW50TGlzdGVuZXIoJ3BsYXknLCB0aGlzLl9vblZpZGVvU3RhcnRUb1BsYXkuYmluZCh0aGlzKSk7XG5cdH07XG5cblx0X29uVmlkZW9TdGFydFRvUGxheShlKSB7XG5cdFx0dGhpcy52aWRlb1dpZHRoID0gdGhpcy5wbGF5ZXJFbC52aWRlb1dpZHRoO1xuXHRcdHRoaXMudmlkZW9IZWlnaHQgPSB0aGlzLnBsYXllckVsLnZpZGVvSGVpZ2h0O1xuXHRcdHRoaXMud2F0Y2hUaGVWaWRlbygpO1xuXHR9O1xuXG5cdHdhdGNoVGhlVmlkZW8oKSB7XG5cdFx0aWYgKHRoaXMucGxheWVyRWwucGF1c2VkIHx8IHRoaXMucGxheWVyRWwuZW5kZWQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXG5cdFx0dGhpcy5wYWludEZyYW1lKCk7XG5cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMud2F0Y2hUaGVWaWRlbygpO1xuXHRcdH0sIDApO1xuXHR9O1xuXG5cdHBhaW50RnJhbWUoKSB7XG5cdFx0dGhpcy5jYW52YXMuY29udGV4dC5kcmF3SW1hZ2UodGhpcy5wbGF5ZXJFbCwgMCwgMCwgdGhpcy52aWRlb1dpZHRoLCB0aGlzLnZpZGVvSGVpZ2h0KTtcblx0XHRsZXQgZnJhbWUgPSB0aGlzLmNhbnZhcy5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLnZpZGVvV2lkdGgsIHRoaXMudmlkZW9IZWlnaHQpO1xuXHRcdGxldCBsZW5ndGggPSBmcmFtZS5kYXRhLmxlbmd0aCAvIDQ7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgciA9IGZyYW1lLmRhdGFbaSAqIDQgKyAwXTtcblx0XHRcdGxldCBnID0gZnJhbWUuZGF0YVtpICogNCArIDFdO1xuXHRcdFx0bGV0IGIgPSBmcmFtZS5kYXRhW2kgKiA0ICsgMl07XG5cdFx0XHRsZXQgYXZlcmFnZSA9IDAuMjEgKiByICsgMC43MiAqIGcgKyAwLjA3ICogYjtcblx0XHRcdGZyYW1lLmRhdGFbaSAqIDQgKyAwXSA9IGF2ZXJhZ2U7XG5cdFx0XHRmcmFtZS5kYXRhW2kgKiA0ICsgMV0gPSBhdmVyYWdlO1xuXHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDJdID0gYXZlcmFnZTtcblx0XHR9O1xuXG5cdFx0dGhpcy5jYW52YXMuY29udGV4dC5wdXRJbWFnZURhdGEoZnJhbWUsIDAsIDApO1xuXG5cblx0XHQvLyBsZXQgZGF0YSA9IGZyYW1lRGF0YS5kYXRhO1xuXHRcdC8vIGxldCBpTGVuID0gZnJhbWVEYXRhLndpZHRoO1xuXHRcdC8vIGxldCBqTGVuID0gZnJhbWVEYXRhLmhlaWdodDtcblx0XHQvLyBsZXQgaW5kZXg7IFxuXHRcdC8vIGxldCBhdmVyYWdlO1xuXG5cdFx0Ly8gZm9yIChsZXQgaSA9IDA7IGkgPCBpTGVuOyBpKyspIHtcblx0XHQvLyBcdGZvciAobGV0IGogPSAwOyBqIDwgakxlbjsgaisrKSB7XG5cdFx0Ly8gXHRcdGluZGV4ID0gKGkgKiA0KSAqIGpMZW4gKyAoaiAqIDQpO1xuXHRcdC8vIFx0XHRhdmVyYWdlID0gKGRhdGFbaW5kZXhdICsgZGF0YVtpbmRleCArIDFdICsgZGF0YVtpbmRleCArIDJdKSAvIDM7XG5cdFx0Ly8gXHRcdGRhdGFbaW5kZXhdID0gYXZlcmFnZTtcblx0XHQvLyBcdFx0ZGF0YVtpbmRleCArIDFdID0gYXZlcmFnZTtcblx0XHQvLyBcdFx0ZGF0YVtpbmRleCArIDJdID0gYXZlcmFnZTtcblx0XHQvLyBcdH07XG5cdFx0Ly8gfTtcblxuXHRcdC8vIHRoaXMuY2FudmFzLmNvbnRleHQucHV0SW1hZ2VEYXRhKGZyYW1lRGF0YSwgMCwgMCk7XG5cdH07XG59O1xuXG5jbGFzcyBDYW52YXMge1xuXHRjb25zdHJ1Y3RvcihlbCkge1xuXHRcdHRoaXMuY2FudmFzRWwgPSBlbDtcblx0XHR0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKTtcblx0fTtcbn07XG5cbmNvbnN0IGFwcCA9IG5ldyBBcHAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcCcpKTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEFwcCA9IGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gQXBwKGVsKSB7XG5cdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFwcCk7XG5cblx0XHR0aGlzLmFwcEVsID0gZWw7XG5cdFx0dGhpcy5mb3JtID0gdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuc291cmNlLWxpbmtzLWZvcm0nKTtcblx0XHR0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5fb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQuYmluZCh0aGlzKSk7XG5cdH1cblxuXHRfY3JlYXRlQ2xhc3MoQXBwLCBbe1xuXHRcdGtleTogJ19vblNvdXJjZUxpbmtzRm9ybVN1Ym1pdCcsXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIF9vblNvdXJjZUxpbmtzRm9ybVN1Ym1pdChlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLnVybE1hcCA9IHtcblx0XHRcdFx0dmlkZW9Vcmw6IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignI3ZpZGVvVXJsJykudmFsdWUsXG5cdFx0XHRcdHN1YlVybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjc3ViVXJsJykudmFsdWUsXG5cdFx0XHRcdGF1ZGlvVXJsOiB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJyNhdWRpb1VybCcpLnZhbHVlXG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuaW5pdGlhbC1wYWdlJykuY2xhc3NMaXN0LmFkZCgnaW5pdGlhbC1wYWdlX2hpZGRlbicpO1xuXHRcdFx0dGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tcGFnZScpLmNsYXNzTGlzdC5yZW1vdmUoJ3ZpZGVvLXBhZ2VfaGlkZGVuJyk7XG5cblx0XHRcdHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyh0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMnKSk7XG5cdFx0XHR0aGlzLnBsYXllciA9IG5ldyBQbGF5ZXIodGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8nKSwgdGhpcy51cmxNYXAudmlkZW9VcmwsIHRoaXMuY2FudmFzKTtcblx0XHR9XG5cdH1dKTtcblxuXHRyZXR1cm4gQXBwO1xufSgpO1xuXG47XG5cbnZhciBQbGF5ZXIgPSBmdW5jdGlvbiAoKSB7XG5cdGZ1bmN0aW9uIFBsYXllcihlbCwgdmlkZW9VcmwsIGNhbnZhcykge1xuXHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQbGF5ZXIpO1xuXG5cdFx0dGhpcy5wbGF5ZXJFbCA9IGVsO1xuXHRcdHRoaXMudmlkZW9VcmwgPSB2aWRlb1VybDtcblx0XHR0aGlzLmNhbnZhcyA9IGNhbnZhcztcblx0XHR0aGlzLnZpZGVvU291cmNlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcblx0XHR0aGlzLnZpZGVvU291cmNlRWwuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLnZpZGVvVXJsKTtcblx0XHR0aGlzLnBsYXllckVsLmFwcGVuZENoaWxkKHRoaXMudmlkZW9Tb3VyY2VFbCk7XG5cdFx0dGhpcy5wbGF5ZXJFbC5hZGRFdmVudExpc3RlbmVyKCdwbGF5JywgdGhpcy5fb25WaWRlb1N0YXJ0VG9QbGF5LmJpbmQodGhpcykpO1xuXHR9XG5cblx0X2NyZWF0ZUNsYXNzKFBsYXllciwgW3tcblx0XHRrZXk6ICdfb25WaWRlb1N0YXJ0VG9QbGF5Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gX29uVmlkZW9TdGFydFRvUGxheShlKSB7XG5cdFx0XHR0aGlzLnZpZGVvV2lkdGggPSB0aGlzLnBsYXllckVsLnZpZGVvV2lkdGg7XG5cdFx0XHR0aGlzLnZpZGVvSGVpZ2h0ID0gdGhpcy5wbGF5ZXJFbC52aWRlb0hlaWdodDtcblx0XHRcdHRoaXMud2F0Y2hUaGVWaWRlbygpO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ3dhdGNoVGhlVmlkZW8nLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiB3YXRjaFRoZVZpZGVvKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdFx0aWYgKHRoaXMucGxheWVyRWwucGF1c2VkIHx8IHRoaXMucGxheWVyRWwuZW5kZWQpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblxuXHRcdFx0dGhpcy5wYWludEZyYW1lKCk7XG5cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRfdGhpcy53YXRjaFRoZVZpZGVvKCk7XG5cdFx0XHR9LCAwKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICdwYWludEZyYW1lJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcGFpbnRGcmFtZSgpIHtcblx0XHRcdHRoaXMuY2FudmFzLmNvbnRleHQuZHJhd0ltYWdlKHRoaXMucGxheWVyRWwsIDAsIDAsIHRoaXMudmlkZW9XaWR0aCwgdGhpcy52aWRlb0hlaWdodCk7XG5cdFx0XHR2YXIgZnJhbWUgPSB0aGlzLmNhbnZhcy5jb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLnZpZGVvV2lkdGgsIHRoaXMudmlkZW9IZWlnaHQpO1xuXHRcdFx0dmFyIGxlbmd0aCA9IGZyYW1lLmRhdGEubGVuZ3RoIC8gNDtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgciA9IGZyYW1lLmRhdGFbaSAqIDQgKyAwXTtcblx0XHRcdFx0dmFyIGcgPSBmcmFtZS5kYXRhW2kgKiA0ICsgMV07XG5cdFx0XHRcdHZhciBiID0gZnJhbWUuZGF0YVtpICogNCArIDJdO1xuXHRcdFx0XHR2YXIgYXZlcmFnZSA9IDAuMjEgKiByICsgMC43MiAqIGcgKyAwLjA3ICogYjtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDBdID0gYXZlcmFnZTtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDFdID0gYXZlcmFnZTtcblx0XHRcdFx0ZnJhbWUuZGF0YVtpICogNCArIDJdID0gYXZlcmFnZTtcblx0XHRcdH07XG5cblx0XHRcdHRoaXMuY2FudmFzLmNvbnRleHQucHV0SW1hZ2VEYXRhKGZyYW1lLCAwLCAwKTtcblxuXHRcdFx0Ly8gbGV0IGRhdGEgPSBmcmFtZURhdGEuZGF0YTtcblx0XHRcdC8vIGxldCBpTGVuID0gZnJhbWVEYXRhLndpZHRoO1xuXHRcdFx0Ly8gbGV0IGpMZW4gPSBmcmFtZURhdGEuaGVpZ2h0O1xuXHRcdFx0Ly8gbGV0IGluZGV4OyBcblx0XHRcdC8vIGxldCBhdmVyYWdlO1xuXG5cdFx0XHQvLyBmb3IgKGxldCBpID0gMDsgaSA8IGlMZW47IGkrKykge1xuXHRcdFx0Ly8gXHRmb3IgKGxldCBqID0gMDsgaiA8IGpMZW47IGorKykge1xuXHRcdFx0Ly8gXHRcdGluZGV4ID0gKGkgKiA0KSAqIGpMZW4gKyAoaiAqIDQpO1xuXHRcdFx0Ly8gXHRcdGF2ZXJhZ2UgPSAoZGF0YVtpbmRleF0gKyBkYXRhW2luZGV4ICsgMV0gKyBkYXRhW2luZGV4ICsgMl0pIC8gMztcblx0XHRcdC8vIFx0XHRkYXRhW2luZGV4XSA9IGF2ZXJhZ2U7XG5cdFx0XHQvLyBcdFx0ZGF0YVtpbmRleCArIDFdID0gYXZlcmFnZTtcblx0XHRcdC8vIFx0XHRkYXRhW2luZGV4ICsgMl0gPSBhdmVyYWdlO1xuXHRcdFx0Ly8gXHR9O1xuXHRcdFx0Ly8gfTtcblxuXHRcdFx0Ly8gdGhpcy5jYW52YXMuY29udGV4dC5wdXRJbWFnZURhdGEoZnJhbWVEYXRhLCAwLCAwKTtcblx0XHR9XG5cdH1dKTtcblxuXHRyZXR1cm4gUGxheWVyO1xufSgpO1xuXG47XG5cbnZhciBDYW52YXMgPSBmdW5jdGlvbiBDYW52YXMoZWwpIHtcblx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbnZhcyk7XG5cblx0dGhpcy5jYW52YXNFbCA9IGVsO1xuXHR0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKTtcbn07XG5cbjtcblxudmFyIGFwcCA9IG5ldyBBcHAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFwcCcpKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
