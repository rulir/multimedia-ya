"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),App=function(){function e(t){_classCallCheck(this,e),this.appEl=t,this.form=this.appEl.querySelector(".source-links-form"),this.form.addEventListener("submit",this._onSourceLinksFormSubmit.bind(this))}return _createClass(e,[{key:"_onSourceLinksFormSubmit",value:function(e){e.preventDefault();var t="./assets/video/overlay.mp4";this.overlayCanvas=this.appEl.querySelector(".canvas-overlay"),this.urlMap={videoUrl:this.appEl.querySelector("#videoUrl").value,subsUrl:this.appEl.querySelector("#subUrl").value,audioUrl:this.appEl.querySelector("#audioUrl").value},this.appEl.querySelector(".initial-page").classList.add("initial-page_hidden"),this.appEl.querySelector(".video-page").classList.remove("video-page_hidden"),this.subs=new Subs(this.urlMap),this.player=new Player(this.appEl.querySelector(".video-custom"),this.urlMap.videoUrl,this.subs),this.overlayPlayer=new Player(this.appEl.querySelector(".video-overlay"),t,this.subs),this.audio=new Audio(this.appEl.querySelector(".audio"),this.urlMap.audioUrl),this.canvas=new Canvas(this.appEl.querySelector(".canvas"),this.player,this.overlayPlayer,this.subs,this.overlayCanvas,this.audio)}}]),e}(),Player=function(){function e(t,i,a){_classCallCheck(this,e),this.playerEl=t,this.videoUrl=i,this.isPlaying=!1,this.width=640,this.height=360,this.playerEl.width=this.width,this.playerEl.height=this.height,this.videoSourceEl=document.createElement("source"),this.videoSourceEl.setAttribute("src",this.videoUrl),this.playerEl.appendChild(this.videoSourceEl)}return _createClass(e,[{key:"play",value:function(){this.playerEl.play()}},{key:"pause",value:function(){this.playerEl.pause()}}]),e}(),Canvas=function(){function e(t,i,a,s,r,l){_classCallCheck(this,e),this.canvasEl=t,this.overlayCanvas=r,this.player=i,this.overlayPlayer=a,this.subs=s,this.audio=l,this.overlayCanvasContext=this.overlayCanvas.getContext("2d"),this.subsCurrСue=0,this.context=this.canvasEl.getContext("2d"),this.canvasEl.addEventListener("click",this._onCanvasClick.bind(this)),this.canvasEl.width=this.player.width,this.canvasEl.height=this.player.height,this.context.fillStyle="rgb(30, 30, 30)",this.context.fillRect(0,0,this.canvasEl.width,this.canvasEl.height)}return _createClass(e,[{key:"_onCanvasClick",value:function(e){if(this.player.isPlaying)this.player.pause(),this.overlayPlayer.pause(),this.audio.pause(),clearTimeout(this.t1),clearTimeout(this.t2),cancelAnimationFrame(this.textReq),cancelAnimationFrame(this.videoReq),this.player.isPlaying=!this.player.isPlaying;else{if(this.checkSubsAvailability(e)===!1)return;this.subs.parsedSubs=this.getNeededSubsForThisTime(),this.subsCurrСue=0,this.player.play(),this.overlayPlayer.play(),this.audio.play(),this.prepareShaders(),this.startTimeСountup(),cancelAnimationFrame(this.textReq),this.videoReq=requestAnimationFrame(this.watchTheVideo.bind(this)),this.player.isPlaying=!this.player.isPlaying}}},{key:"getNeededSubsForThisTime",value:function(){var e=parseInt(1e3*this.player.playerEl.currentTime),t=this.subs.parsedSubs.filter(function(t){if(t.endTime>=e)return!0});return t}},{key:"resumePlayAfterSubs",value:function(){this.player.play(),this.startTimeСountup(),cancelAnimationFrame(this.textReq),this.videoReq=requestAnimationFrame(this.watchTheVideo.bind(this))}},{key:"startTimeСountup",value:function(){var e=this,t=this.subs.parsedSubs[this.subsCurrСue].endTime-1e3*parseInt(this.player.playerEl.currentTime),i=this.subs.parsedSubs[this.subsCurrСue].endTime-this.subs.parsedSubs[this.subsCurrСue].startTime;this.t1=setTimeout(function(){e.player.pause(),cancelAnimationFrame(e.videoReq),e.textReq=requestAnimationFrame(e.drawText.bind(e)),clearTimeout(e.t1),e.t2=setTimeout(function(){e.subsCurrСue<e.subs.parsedSubs.length-1?e.subsCurrСue++:e.subsCurrСue=0,e.resumePlayAfterSubs(),clearTimeout(e.t2)},i)},t)}},{key:"watchTheVideo",value:function(){this.paintFrame(),cancelAnimationFrame(this.textReq),this.videoReq=requestAnimationFrame(this.watchTheVideo.bind(this))}},{key:"paintFrame",value:function(){this.context.drawImage(this.player.playerEl,0,0,this.player.width,this.player.height),this.context.globalCompositeOperation="color",this.context.fillStyle="rgb(255, 255, 255)",this.context.fillRect(0,0,this.canvasEl.width,this.canvasEl.height),this.paintOverlayEffect()}},{key:"prepareShaders",value:function(){var e=[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1],t=document.querySelector(".canvas-webgl"),i=t.getContext("experimental-webgl"),a=function(e,t){var a=i.createShader(t);return i.shaderSource(a,e),i.compileShader(a),a},s=function(e){for(var t=document.getElementById(e),s="",r=t.firstChild;r;)3==r.nodeType&&(s+=r.textContent,r=r.nextSibling);var l=void 0;if("x-shader/x-fragment"==t.type)l=a(s,i.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!=t.type)return null;l=a(s,i.VERTEX_SHADER)}return l},r=s("vertex-shader"),l=s("fragment-shader");console.dir(r,l);var n=i.createProgram();i.attachShader(n,r),i.attachShader(n,l),i.linkProgram(n),i.useProgram(n),i.deleteShader(r),i.deleteShader(l);var h=i.getAttribLocation(n,"aVertexPosition"),u=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,u),i.bufferData(i.ARRAY_BUFFER,new Float32Array(e),i.STATIC_DRAW),i.enableVertexAttribArray(h),i.vertexAttribPointer(h,2,i.FLOAT,!1,0,0);var o=function(){i.drawArrays(i.TRIANGLES,0,6)},c=function p(){requestAnimationFrame(p),o()};c()}},{key:"paintOverlayEffect",value:function(){this.overlayCanvasContext.drawImage(this.overlayPlayer.playerEl,0,0,this.overlayPlayer.width,this.overlayPlayer.height);var e=this.overlayCanvasContext.getImageData(0,0,this.canvasEl.width,this.canvasEl.height);this.overlayCanvasContext.putImageData(e,0,0),this.context.globalCompositeOperation="multiply",this.context.drawImage(this.overlayCanvas,0,0,this.canvasEl.width,this.canvasEl.height),this.context.globalCompositeOperation="source-over"}},{key:"drawText",value:function(e){this.context.fillStyle="rgb(50, 50, 50)",this.context.fillRect(0,0,this.canvasEl.width,this.canvasEl.height),this.context.font="36px Oranienbaum",this.context.textAlign="center",this.context.fillStyle="rgb(255, 255, 255)",this.wrapText(this.subs.parsedSubs[this.subsCurrСue].text,this.canvasEl.width,40,this.canvasEl.width/2,this.canvasEl.height/2),this.paintOverlayEffect(),cancelAnimationFrame(this.videoReq),this.textReq=requestAnimationFrame(this.drawText.bind(this))}},{key:"wrapText",value:function(e,t,i,a,s){for(var r=e.split(" "),l="",n=0;n<r.length;n++){var h=l+r[n]+" ",u=this.context.measureText(h).width;u>t-50?(this.context.fillText(l,a,s),l=r[n]+" ",s+=i):l=h}this.context.fillText(l,a,s)}},{key:"checkSubsAvailability",value:function(e){if(!this.subs.ready)return e.preventDefault(),this.player.pause(),this.player.playerEl.currentTime=0,!1}}]),e}(),Subs=function(){function e(t){var i=this;_classCallCheck(this,e),this.ready=!1,fetch(t.subsUrl).then(function(e){e.text().then(function(e){i.parsedSubs=i.parseFromSrt(e),i.ready=!0})})}return _createClass(e,[{key:"parseFromSrt",value:function(e){function t(e,t){var i=t[e].split(":"),a=i[0],s=Number(i[1]),r=i[2].split(","),l=Number(r[0]),n=Number(r[1]);t[e]=36e5*a+6e4*s+1e3*l+n}var i=parser.fromSrt(e);return i.map(function(e){t("endTime",e),t("startTime",e)}),i}}]),e}(),Audio=function(){function e(t,i){_classCallCheck(this,e),this.audioEl=t,this.url=i,this.audioSourceEl=document.createElement("source"),this.audioSourceEl.setAttribute("src",this.url),this.audioEl.appendChild(this.audioSourceEl)}return _createClass(e,[{key:"play",value:function(){this.audioEl.play()}},{key:"pause",value:function(){this.audioEl.pause()}}]),e}(),app=new App(document.querySelector(".app"));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImJ1bmRsZS5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIkFwcCIsImVsIiwidGhpcyIsImFwcEVsIiwiZm9ybSIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX29uU291cmNlTGlua3NGb3JtU3VibWl0IiwiYmluZCIsInZhbHVlIiwiZSIsInByZXZlbnREZWZhdWx0Iiwib3ZlcmxheVZpZGVvVXJsIiwib3ZlcmxheUNhbnZhcyIsInVybE1hcCIsInZpZGVvVXJsIiwic3Vic1VybCIsImF1ZGlvVXJsIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic3VicyIsIlN1YnMiLCJwbGF5ZXIiLCJQbGF5ZXIiLCJvdmVybGF5UGxheWVyIiwiYXVkaW8iLCJBdWRpbyIsImNhbnZhcyIsIkNhbnZhcyIsInVybCIsInBsYXllckVsIiwiaXNQbGF5aW5nIiwid2lkdGgiLCJoZWlnaHQiLCJ2aWRlb1NvdXJjZUVsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJwbGF5IiwicGF1c2UiLCJjYW52YXNFbCIsIm92ZXJsYXlDYW52YXNDb250ZXh0IiwiZ2V0Q29udGV4dCIsInN1YnNDdXJy0KF1ZSIsImNvbnRleHQiLCJfb25DYW52YXNDbGljayIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiY2xlYXJUaW1lb3V0IiwidDEiLCJ0MiIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwidGV4dFJlcSIsInZpZGVvUmVxIiwiY2hlY2tTdWJzQXZhaWxhYmlsaXR5IiwicGFyc2VkU3VicyIsImdldE5lZWRlZFN1YnNGb3JUaGlzVGltZSIsInByZXBhcmVTaGFkZXJzIiwic3RhcnRUaW1l0KFvdW50dXAiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ3YXRjaFRoZVZpZGVvIiwiY3VycmVudFRpbWUiLCJwYXJzZUludCIsImZpbHRlcmVkU3VicyIsImZpbHRlciIsIml0ZW0iLCJlbmRUaW1lIiwiX3RoaXMiLCJkZWxheVRvU3RhcnRPZlN1YnMiLCJwYXVzZUR1cmF0aW9uIiwic3RhcnRUaW1lIiwic2V0VGltZW91dCIsImRyYXdUZXh0IiwicmVzdW1lUGxheUFmdGVyU3VicyIsInBhaW50RnJhbWUiLCJkcmF3SW1hZ2UiLCJnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24iLCJwYWludE92ZXJsYXlFZmZlY3QiLCJ2ZXJ0aWNlcyIsIndlYmdsQ2FudmFzIiwiZ2wiLCJjb21waWxlU2hhZGVyIiwic2hhZGVyU291cmNlIiwic2hhZGVyVHlwZSIsInNoYWRlciIsImNyZWF0ZVNoYWRlciIsImdldFNoYWRlciIsImlkIiwic2hhZGVyU2NyaXB0IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0ZXh0TGluZSIsImZpcnN0Q2hpbGQiLCJub2RlVHlwZSIsInRleHRDb250ZW50IiwibmV4dFNpYmxpbmciLCJ0eXBlIiwiRlJBR01FTlRfU0hBREVSIiwiVkVSVEVYX1NIQURFUiIsInZlcnRleFNoYWRlciIsImZyYWdtZW50aGFkZXIiLCJjb25zb2xlIiwiZGlyIiwic2hhZGVyUHJvZ3JhbSIsImNyZWF0ZVByb2dyYW0iLCJhdHRhY2hTaGFkZXIiLCJsaW5rUHJvZ3JhbSIsInVzZVByb2dyYW0iLCJkZWxldGVTaGFkZXIiLCJ2ZXJ0ZXhQb3NpdGlvbkxvY2F0aW9uIiwiZ2V0QXR0cmliTG9jYXRpb24iLCJidWZmZXIiLCJjcmVhdGVCdWZmZXIiLCJiaW5kQnVmZmVyIiwiQVJSQVlfQlVGRkVSIiwiYnVmZmVyRGF0YSIsIkZsb2F0MzJBcnJheSIsIlNUQVRJQ19EUkFXIiwiZW5hYmxlVmVydGV4QXR0cmliQXJyYXkiLCJ2ZXJ0ZXhBdHRyaWJQb2ludGVyIiwiRkxPQVQiLCJkcmF3IiwiZHJhd0FycmF5cyIsIlRSSUFOR0xFUyIsInJlbmRlciIsImltYWdlRGF0YSIsImdldEltYWdlRGF0YSIsInB1dEltYWdlRGF0YSIsInRleHQiLCJmb250IiwidGV4dEFsaWduIiwid3JhcFRleHQiLCJtYXhXaWR0aCIsImxpbmVIZWlnaHQiLCJtYXJnaW5MZWZ0IiwibWFyZ2luVG9wIiwid29yZHMiLCJzcGxpdCIsImxpbmUiLCJ0ZW1wb3JhcnlUZXh0TGluZSIsInRlbXBvcmFyeVRleHRMaW5lV2lkdGgiLCJtZWFzdXJlVGV4dCIsImZpbGxUZXh0IiwicmVhZHkiLCJfdGhpczIiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJkYXRhIiwicGFyc2VGcm9tU3J0Iiwic3J0IiwidGltZVBhcnNlVG9NcyIsInRpbWVUeXBlIiwic3Vic1N0YXJ0VGltZUJ1ZmZlciIsImhvdXJzIiwibWlucyIsIk51bWJlciIsInNlY3NBbmRNc2Vjc0J1ZmZlciIsInNlY3MiLCJtc2VjcyIsInBhcnNlciIsImZyb21TcnQiLCJtYXAiLCJhdWRpb0VsIiwiYXVkaW9Tb3VyY2VFbCIsImFwcCJdLCJtYXBwaW5ncyI6IkFBQUEsWUNNQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FGaEgsR0FBSUMsY0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV0MsV0FBYUQsRUFBV0MsYUFBYyxFQUFPRCxFQUFXRSxjQUFlLEVBQVUsU0FBV0YsS0FBWUEsRUFBV0csVUFBVyxHQUFNQyxPQUFPQyxlQUFlVCxFQUFRSSxFQUFXTSxJQUFLTixJQUFpQixN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b3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuLyrQutC70LDRgdGBINC/0YDQuNC70L7QttC10L3QuNGPKi9cbmNsYXNzIEFwcCB7XG5cdGNvbnN0cnVjdG9yKGVsKSB7XG5cdFx0dGhpcy5hcHBFbCA9IGVsO1xuXHRcdHRoaXMuZm9ybSA9IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnNvdXJjZS1saW5rcy1mb3JtJyk7XG5cdFx0dGhpcy5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuX29uU291cmNlTGlua3NGb3JtU3VibWl0LmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdC8q0L7QsdGA0LDQsdC+0YLRh9C40Log0YHQvtCx0YvRgtC40Y8g0L7RgtC/0YDQsNCy0LrQuCDRhNC+0YDQvNGLLiDQodC+0LHQuNGA0LDQtdGCINC00LDQvdC90YvQtSDQuNC3INC/0L7Qu9C1INC4INC+0YHRg9GJ0LXRgdGC0LLQu9GP0LXRgiDQuNC90LjRhtC40LDQu9C40LfQsNGG0LjRjiDRjdC70LXQvNC10L3RgtC+0LIg0LLRgtC+0YDQvtC5INGB0YLRgNCw0L3QuNGG0YsqL1xuXHRfb25Tb3VyY2VMaW5rc0Zvcm1TdWJtaXQoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRsZXQgb3ZlcmxheVZpZGVvVXJsID0gJy4vYXNzZXRzL3ZpZGVvL292ZXJsYXkubXA0JzsgLy/QstC40LTQtdC+INC00LvRjyDRgdC+0LfQtNCw0L3QuNGPINGN0YTRhNC10LrRgtCwINGB0YLQsNGA0LjQvdGLXG5cdFx0dGhpcy5vdmVybGF5Q2FudmFzID0gdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuY2FudmFzLW92ZXJsYXknKTsgLy/Rg9C30LXQuyDQutCw0L3QstCw0YHQsCDQtNC70Y8g0L7RgtGA0LjRgdC+0LLQutC4INGN0YTQtdC60YLQsCDRgdGC0LDRgNC40L3Ri1xuXG5cdFx0LyrRg9GA0LvRiyDQstC40LTQtdC+LCDQsNGD0LTQuNC+INC4INGB0YPQsdGC0LjRgtGA0L7QsiDQstCy0LXQtNC10L3QvdGL0LUg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9C10LwqL1xuXHRcdHRoaXMudXJsTWFwID0ge1xuXHRcdFx0dmlkZW9Vcmw6IHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignI3ZpZGVvVXJsJykudmFsdWUsXG5cdFx0XHRzdWJzVXJsOiB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJyNzdWJVcmwnKS52YWx1ZSxcblx0XHRcdGF1ZGlvVXJsOiB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJyNhdWRpb1VybCcpLnZhbHVlLFxuXHRcdH07XG5cdFx0dGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuaW5pdGlhbC1wYWdlJykuY2xhc3NMaXN0LmFkZCgnaW5pdGlhbC1wYWdlX2hpZGRlbicpOyAvL9GB0YLRgNCw0L3QuNGG0LAg0YEg0YTQvtGA0LzQvtC5XG5cdFx0dGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tcGFnZScpLmNsYXNzTGlzdC5yZW1vdmUoJ3ZpZGVvLXBhZ2VfaGlkZGVuJyk7IC8v0YHRgtGA0LDQvdC40YbQsCDRgSDQstC40LTQtdC+XG5cdFx0dGhpcy5zdWJzID0gbmV3IFN1YnModGhpcy51cmxNYXApOyAvL9C40L3RgdGC0LDQvdGBINC60LvQsNGB0YHQsCDQtNC70Y8g0YDQsNCx0L7RgtGLINGBINGB0YPQsdGC0LjRgtGA0LDQvNC4XG5cdFx0dGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvLWN1c3RvbScpLCB0aGlzLnVybE1hcC52aWRlb1VybCwgdGhpcy5zdWJzKTsgLy/QuNC90YHRgtCw0L3RgSDQv9C70LXQtdGA0LAg0LTQu9GPINC/0YDQvtC40LPRgNGL0LLQsNC90LjRjyDQt9Cw0LPRgNGD0LbQtdC90L3QvtCz0L4g0LLQuNC00LXQvlxuXHRcdHRoaXMub3ZlcmxheVBsYXllciA9IG5ldyBQbGF5ZXIodGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcudmlkZW8tb3ZlcmxheScpLCBvdmVybGF5VmlkZW9VcmwsIHRoaXMuc3Vicyk7IC8v0LjQvdGB0YLQsNC90YEg0L/Qu9C10LXRgNCwINC00LvRjyDQv9GA0L7QuNGA0YvQstCw0L3QuNGPINCy0LjQtNC10L4g0YEg0Y3RhNGE0LXQutGC0L7QvCDRgdGC0LDRgNC40L3Ri1xuXHRcdHRoaXMuYXVkaW8gPSBuZXcgQXVkaW8odGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuYXVkaW8nKSwgdGhpcy51cmxNYXAuYXVkaW9VcmwpOyAvL9C40L3RgdGC0LDQvdGBINC00LvRjyDRgNCw0LHQvtGC0Ysg0YEg0LDRg9C00LjQvlxuXHRcdHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyh0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMnKSwgdGhpcy5wbGF5ZXIsIHRoaXMub3ZlcmxheVBsYXllciwgdGhpcy5zdWJzLCB0aGlzLm92ZXJsYXlDYW52YXMsIHRoaXMuYXVkaW8pO1xuXHR9O1xufTtcblxuXG4vKtC60LvQsNGB0YEg0LTQu9GPINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNC4INCy0LjQtNC10L7Qv9C70LXQtdGA0LAqL1xuY2xhc3MgUGxheWVyIHtcblx0Y29uc3RydWN0b3IoZWwsIHVybCwgc3Vicykge1xuXHRcdHRoaXMucGxheWVyRWwgPSBlbDtcblx0XHR0aGlzLnZpZGVvVXJsID0gdXJsO1xuXHRcdHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG5cdFx0dGhpcy53aWR0aCA9IDY0MDsgLy/RiNC40YDQuNC90LAg0LLQuNC00LXQvlxuXHRcdHRoaXMuaGVpZ2h0ID0gMzYwOyAvL9Cy0YvRgdC+0YLQsCDQstC40LTQtdC+XG5cdFx0dGhpcy5wbGF5ZXJFbC53aWR0aCA9IHRoaXMud2lkdGg7XG5cdFx0dGhpcy5wbGF5ZXJFbC5oZWlnaHQgPSB0aGlzLmhlaWdodDtcblx0XHR0aGlzLnZpZGVvU291cmNlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTsgLy/RgdC+0LfQtNCw0YLRjCDRjdC70LXQvNC10L3RgiA8c291cmNlPlxuXHRcdHRoaXMudmlkZW9Tb3VyY2VFbC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMudmlkZW9VcmwpOyAvL9GD0YHRgtCw0L3QvtCy0LjRgtGMINC40YHRgtC+0YfQvdC40Lpcblx0XHR0aGlzLnBsYXllckVsLmFwcGVuZENoaWxkKHRoaXMudmlkZW9Tb3VyY2VFbCk7IC8v0LTQvtCx0LDQstC40YLRjCA8c291cmNlPiDQstC90YPRgtGA0YwgPHZpZGVvPlxuXHR9O1xuXG5cdHBsYXkoKSB7XG5cdFx0dGhpcy5wbGF5ZXJFbC5wbGF5KCk7IC8v0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNC1INCy0LjQtNC10L5cblx0fTtcblxuXHRwYXVzZSgpIHtcblx0XHR0aGlzLnBsYXllckVsLnBhdXNlKCk7IC8v0L/QsNGD0LfQsFxuXHR9O1xufTtcblxuLyrQutC70LDRgdGBINC00LvRjyDQuNC90LjRhtC40LDQu9C40LfQsNGG0LjQuCDQutCw0L3QstCw0YHQsCovXG5jbGFzcyBDYW52YXMge1xuXHRjb25zdHJ1Y3RvcihlbCwgcGxheWVyLCBvdmVybGF5UGxheWVyLCBzdWJzLCBvdmVybGF5Q2FudmFzLCBhdWRpbykge1xuXHRcdHRoaXMuY2FudmFzRWwgPSBlbDsgLy/Rg9C30LXQuyA8Y2FudmFzPiDQvdCwINC60L7RgtC+0YDQvtC8INCx0YPQtNC10Lwg0YDQuNGB0L7QstCw0YLRjFxuXHRcdHRoaXMub3ZlcmxheUNhbnZhcyA9IG92ZXJsYXlDYW52YXM7IC8vINGD0LfQutC7IDxjYW52YXM+INC00LvRjyDQvtGC0YDQuNGB0L7QstC60Lgg0Y3RhNC10LXQutGC0LAg0YHRgtCw0YDQuNC90Ytcblx0XHR0aGlzLnBsYXllciA9IHBsYXllcjsgLy/Qv9C70LXQtdGAINC00LvRjyDQv9GA0L7QuNCz0YDRi9Cy0LDQvdC40Y8g0LfQsNCz0YDRg9C20LXQvdC90L7Qs9C+INCy0LjQtNC10L5cblx0XHR0aGlzLm92ZXJsYXlQbGF5ZXIgPSBvdmVybGF5UGxheWVyOyAvL9C/0LvQtdC10YAg0LTQu9GPINC/0YDQvtC40LPRgNGL0LLQsNC90LjRjyDQstC40LTQtdC+INGBINGN0YTRhNC10LrRgtC+0Lxcblx0XHR0aGlzLnN1YnMgPSBzdWJzOyAvL9C+0LHRitC10LrRgiDRgSDRgNCw0YHQv9Cw0YDRgdC10L3QvdGL0LzQuCDRgdGD0LHRgtC40YLRgNCw0LzQuFxuXHRcdHRoaXMuYXVkaW8gPSBhdWRpbzsgLy/QsNGD0LTQuNC+0L/Qu9C10LXRgFxuXHRcdHRoaXMub3ZlcmxheUNhbnZhc0NvbnRleHQgPSB0aGlzLm92ZXJsYXlDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHRcdHRoaXMuc3Vic0N1cnLQoXVlID0gMDsgLy/Qv9C+0LfQuNGG0LjRjyDRgtC10LrRg9GJ0LXQuSDRgNC10L/Qu9C40LrQuCDQsiDRgdGD0LHRgtC40YLRgNCw0YUsINC80LXQvdGP0Y/QtdGC0YHRjyDQv9C+0YHQu9C1INC/0L7QutCw0LfQsCDQutCw0LbQtNC+0Lkg0YTRgNCw0LfRi1xuXHRcdHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzRWwuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHRcdHRoaXMuY2FudmFzRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNhbnZhc0NsaWNrLmJpbmQodGhpcykpOyAvL9Cy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjQtS/Qv9Cw0YPQt9CwINC/0L4g0LrQu9C40LrRg1xuXHRcdHRoaXMuY2FudmFzRWwud2lkdGggPSB0aGlzLnBsYXllci53aWR0aDsgLy/RgNCw0LfQvNC10YDRiyDQutCw0L3QstCw0YHQsCDQtNC70Y8g0YDQsNCy0L3RiyDRgNCw0LfQvNC10YDRgyDQstC40LTQtdC+0L/Qu9C10LXRgNCwXG5cdFx0dGhpcy5jYW52YXNFbC5oZWlnaHQgPSB0aGlzLnBsYXllci5oZWlnaHQ7XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICdyZ2IoMzAsIDMwLCAzMCknO1xuXHRcdHRoaXMuY29udGV4dC5maWxsUmVjdCgwLCAwLCB0aGlzLmNhbnZhc0VsLndpZHRoLCB0aGlzLmNhbnZhc0VsLmhlaWdodCk7XG5cdH07XG5cblx0LyrQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUv0L/QsNGD0LfQsCovXG5cdF9vbkNhbnZhc0NsaWNrKGUpIHtcblx0XHRpZiAodGhpcy5wbGF5ZXIuaXNQbGF5aW5nKSB7XG5cdFx0XHR0aGlzLnBsYXllci5wYXVzZSgpOyAvL9C+0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INC/0LvQtdC10YAg0YEg0LfQsNCz0YDRg9C20LXQvdC90YvQvCDQstC40LTQtdC+INC4INCy0LjQtNC10L4g0YEg0Y3RhNGE0LXQutGC0L7QvFxuXHRcdFx0dGhpcy5vdmVybGF5UGxheWVyLnBhdXNlKCk7XG5cdFx0XHR0aGlzLmF1ZGlvLnBhdXNlKCk7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy50MSk7IC8v0L7Rh9C40YnQsNC10Lwg0LjQvdGC0LXRgNCy0LDQu9GLINC/0L7QutCw0LfQsCDRgdGD0LHRgtC40YLRgNC+0LJcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnQyKTtcblx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudGV4dFJlcSk7IC8v0L7Rh9C40YnQsNC10LwgZnJhbWUgcmVxdWVzdNGLINC+0YLRgNC40YHQvtCy0YvQstCw0Y7RidC40LUg0YLQtdC60YHRgiDQuCDQuNC30L7QsdGA0LDQttC10L3QuNC1XG5cdFx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnZpZGVvUmVxKTtcblx0XHRcdHRoaXMucGxheWVyLmlzUGxheWluZyA9ICF0aGlzLnBsYXllci5pc1BsYXlpbmc7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh0aGlzLmNoZWNrU3Vic0F2YWlsYWJpbGl0eShlKSA9PT0gZmFsc2UpIHsgLy/Qv9GA0L7QstC10YDRj9C10Lwg0LTQvtGB0YLRg9C/0L3RiyDQu9C4INGB0YPQsdGC0LjRgtGA0Ytcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblx0XHRcdHRoaXMuc3Vicy5wYXJzZWRTdWJzID0gdGhpcy5nZXROZWVkZWRTdWJzRm9yVGhpc1RpbWUoKTsgLy/RhNC40LvRjNGC0YDRg9C10Lwg0LzQsNGB0LjQsiDRgSDRgdGD0LHRgtC40YLRgNCw0LzQuCDQsiDRgdC+0L7RgtCy0LXRgtGB0Y/QstC40Lgg0YEg0YLQtdC60YPRidC40Lwg0LLRgNC10LzQtdC90LXQvCDQv9GA0L7QuNCz0YDRi9Cy0LDQvdC40Y9cblx0XHRcdHRoaXMuc3Vic0N1cnLQoXVlID0gMDsgLy/QvdCw0YfQuNC90LDQtdC8INGBINC/0LXRgNCy0L7QuSDRgNC10L/Qu9C40LrQuFxuXHRcdFx0dGhpcy5wbGF5ZXIucGxheSgpO1xuXHRcdFx0dGhpcy5vdmVybGF5UGxheWVyLnBsYXkoKTtcblx0XHRcdHRoaXMuYXVkaW8ucGxheSgpO1xuXHRcdFx0dGhpcy5wcmVwYXJlU2hhZGVycygpO1xuXHRcdFx0dGhpcy5zdGFydFRpbWXQoW91bnR1cCgpOyAvL9C90LDRh9C40L3QsNC10Lwg0LLRi9GH0LjRgdC70Y/RgtGMINCy0YDQtdC80Y8g0LTQviDQv9C+0LrQsNC30LAg0YHRg9Cx0YLQuNGC0YDQvtCyXG5cdFx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnRleHRSZXEpO1xuXHRcdFx0dGhpcy52aWRlb1JlcSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLndhdGNoVGhlVmlkZW8uYmluZCh0aGlzKSk7IC8v0L7RgtGA0LjRgdC+0LLRi9Cy0LDQtdC8INC60LDQtNGAXG5cdFx0XHR0aGlzLnBsYXllci5pc1BsYXlpbmcgPSAhdGhpcy5wbGF5ZXIuaXNQbGF5aW5nO1xuXHRcdH07XG5cdH07XG5cblx0LyrRhNGD0L3QutGG0LjRjyDQtNC70Y8g0YTQuNC70YzRgtGA0LDRhtC40Lgg0YHRg9Cx0YLQuNGC0YDQvtCyINC/0YDQuCDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40Lgg0L/QvtGB0LvQtSDQv9Cw0YPQt9GLINC40LvQuCDQv9C10YDQtdC80L7RgtC60LgqL1xuXHRnZXROZWVkZWRTdWJzRm9yVGhpc1RpbWUoKSB7XG5cdFx0bGV0IGN1cnJlbnRUaW1lID0gcGFyc2VJbnQodGhpcy5wbGF5ZXIucGxheWVyRWwuY3VycmVudFRpbWUgKiAxMDAwKTtcblx0XHRsZXQgZmlsdGVyZWRTdWJzID0gdGhpcy5zdWJzLnBhcnNlZFN1YnMuZmlsdGVyKGl0ZW0gPT4ge1xuXHRcdFx0aWYgKGl0ZW0uZW5kVGltZSA+PSBjdXJyZW50VGltZSkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdFx0cmV0dXJuIGZpbHRlcmVkU3ViczsgLy/QstC+0LfQstGC0YDQsNGJ0LDQtdC8INC80LDRgdGB0LjQsiDRgSDRgNC10L/Qu9C40LrQsNC80Lgg0L3QsNGH0LjQvdCw0Y8g0YEg0LHQu9C40LbQsNC50YjQtdC5XG5cdH07XG5cblx0LyrQv9GA0L7QtNC+0LvQttCw0LXQvCDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUg0LLQuNC00LXQviwg0L/QvtGB0LvQtSDQv9C+0LrQsNC30LAg0YHRg9Cx0YLQuNGC0YDQvtCyKi9cblx0cmVzdW1lUGxheUFmdGVyU3VicygpIHtcblx0XHR0aGlzLnBsYXllci5wbGF5KCk7XG5cdFx0dGhpcy5zdGFydFRpbWXQoW91bnR1cCgpO1xuXHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudGV4dFJlcSk7XG5cdFx0dGhpcy52aWRlb1JlcSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLndhdGNoVGhlVmlkZW8uYmluZCh0aGlzKSk7XG5cdH07XG5cblx0c3RhcnRUaW1l0KFvdW50dXAoKSB7XG5cdFx0LyrQstGL0YfQuNGB0LvRj9C10Lwg0LLRgNC10LzRjyDQtNC+INC90LDRh9Cw0LvQsCDQv9C+0LrQsNC30LAg0YHRg9Cx0YLQuNGC0YDQvtCyKi9cblx0XHRsZXQgZGVsYXlUb1N0YXJ0T2ZTdWJzID0gdGhpcy5zdWJzLnBhcnNlZFN1YnNbdGhpcy5zdWJzQ3VyctChdWVdLmVuZFRpbWUgLSAocGFyc2VJbnQodGhpcy5wbGF5ZXIucGxheWVyRWwuY3VycmVudFRpbWUpICogMTAwMCk7XG5cdFx0LyrQstGL0YfQuNGB0LvRj9C10Lwg0LLRgNC10LzRjyDQv9C+0LrQsNC30LAqL1xuXHRcdGxldCBwYXVzZUR1cmF0aW9uID0gdGhpcy5zdWJzLnBhcnNlZFN1YnNbdGhpcy5zdWJzQ3VyctChdWVdLmVuZFRpbWUgLSB0aGlzLnN1YnMucGFyc2VkU3Vic1t0aGlzLnN1YnNDdXJy0KF1ZV0uc3RhcnRUaW1lO1xuXG5cdFx0LyrQttC00LXQvCDQv9C+0LrQsCDQv9GA0LjQudC00LXRgiDQstGA0LXQvNGPINC/0L7QutCw0LfQsNGC0Ywg0YHRg9Cx0YLQuNGC0YDRiyovXG5cdFx0dGhpcy50MSA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5wbGF5ZXIucGF1c2UoKTtcblx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudmlkZW9SZXEpO1xuXHRcdFx0Ly/RgNC40YHRg9C10Lwg0YHRg9Cx0YLQuNGC0YDRi1xuXHRcdFx0dGhpcy50ZXh0UmVxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuZHJhd1RleHQuYmluZCh0aGlzKSk7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy50MSk7XG5cblx0XHRcdC8q0LbQtNC10Lwg0L/QvtC60LAg0L/RgNC40LnQtNC10YIg0LLRgNC10LzRjyDQv9GA0L7QtNC+0LvQttC40YLRjCDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUqL1xuXHRcdFx0dGhpcy50MiA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHQvKtC/0YDQvtCy0LXRgNGP0LXQvCDQvdC1INC30LDQutC+0L3Rh9C40LvQuNGB0Ywg0LvQuCDRgdGD0LHRgtC40YLRgNGLKi9cblx0XHRcdFx0aWYgKHRoaXMuc3Vic0N1cnLQoXVlIDwgKHRoaXMuc3Vicy5wYXJzZWRTdWJzLmxlbmd0aCAtIDEpKSB7XG5cdFx0XHRcdFx0dGhpcy5zdWJzQ3VyctChdWUrKztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLnN1YnNDdXJy0KF1ZSA9IDA7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5yZXN1bWVQbGF5QWZ0ZXJTdWJzKCk7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnQyKTtcblx0XHRcdH0sIHBhdXNlRHVyYXRpb24pO1xuXHRcdH0sIGRlbGF5VG9TdGFydE9mU3Vicyk7XG5cdH07XG5cblx0Ly/RgNC40YHRg9C10Lwg0LrQsNC00YAg0YEg0L/QtdGA0LXQvtC00LjRh9C90L7RgdGC0YzRjiDQutCw0LTRgNC+0LIg0LIg0YHQtdC6XG5cdHdhdGNoVGhlVmlkZW8oKSB7XG5cdFx0dGhpcy5wYWludEZyYW1lKCk7XG5cdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50ZXh0UmVxKTtcblx0XHR0aGlzLnZpZGVvUmVxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMud2F0Y2hUaGVWaWRlby5iaW5kKHRoaXMpKTtcblx0fTtcblxuXHQvL9GE0YPQvdC60YbQuNGPINC+0YLRgNC40YHQvtCy0LrQuCDQutCw0LTRgNCwINGBINGN0YTRhNC10LrRgtC+0LwgZ3JheXNjYWxlXG5cdHBhaW50RnJhbWUoKSB7XG5cdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZSh0aGlzLnBsYXllci5wbGF5ZXJFbCwgMCwgMCwgdGhpcy5wbGF5ZXIud2lkdGgsIHRoaXMucGxheWVyLmhlaWdodCk7XG5cdFx0Ly/RgNC10LbQuNC8INC90LDQu9C+0LbQtdC90LjRjyDQv9C+0LfQstC+0LvRj9C10YIg0LTQvtCx0LjRgtGB0Y8g0YfQtdGA0L3Qvi3QsdC10LvQvtC5INC60LDRgNGC0LjQvdC60Lhcblx0XHR0aGlzLmNvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2NvbG9yJztcblx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYigyNTUsIDI1NSwgMjU1KSc7XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0XHQvL9GA0LjRgdGD0LXQvCDRjdGE0YTQtdC60YIg0YHRgtCw0YDQuNC90Ytcblx0XHR0aGlzLnBhaW50T3ZlcmxheUVmZmVjdCgpO1xuXHR9O1xuXG5cdHByZXBhcmVTaGFkZXJzKCkge1xuXHRcdGxldCB2ZXJ0aWNlcyA9IFstMS4wLCAtMS4wLFxuXHRcdFx0MS4wLCAtMS4wLCAtMS4wLCAxLjAsXG5cblx0XHRcdC0xLjAsIDEuMCxcblx0XHRcdDEuMCwgLTEuMCxcblx0XHRcdDEuMCwgMS4wXG5cdFx0XTtcblxuXHRcdGxldCB3ZWJnbENhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMtd2ViZ2wnKTtcblx0XHRsZXQgZ2wgPSB3ZWJnbENhbnZhcy5nZXRDb250ZXh0KFwiZXhwZXJpbWVudGFsLXdlYmdsXCIpO1xuXG5cdFx0bGV0IGNvbXBpbGVTaGFkZXIgPSBmdW5jdGlvbihzaGFkZXJTb3VyY2UsIHNoYWRlclR5cGUpIHtcblx0XHRcdGxldCBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIoc2hhZGVyVHlwZSk7XG5cdFx0XHRnbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzaGFkZXJTb3VyY2UpO1xuXHRcdFx0Z2wuY29tcGlsZVNoYWRlcihzaGFkZXIpO1xuXHRcdFx0cmV0dXJuIHNoYWRlcjtcblx0XHR9O1xuXG5cdFx0bGV0IGdldFNoYWRlciA9IGZ1bmN0aW9uKGlkKSB7XG5cdFx0XHRsZXQgc2hhZGVyU2NyaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuXHRcdFx0bGV0IHNoYWRlclNvdXJjZSA9IFwiXCI7XG5cdFx0XHRsZXQgdGV4dExpbmUgPSBzaGFkZXJTY3JpcHQuZmlyc3RDaGlsZDtcblx0XHRcdHdoaWxlKHRleHRMaW5lKSB7XG5cdFx0XHRcdGlmICh0ZXh0TGluZS5ub2RlVHlwZSA9PSAzKSB7XG5cdFx0XHRcdFx0c2hhZGVyU291cmNlICs9IHRleHRMaW5lLnRleHRDb250ZW50O1xuXHRcdFx0XHRcdHRleHRMaW5lID0gdGV4dExpbmUubmV4dFNpYmxpbmc7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXG5cdFx0XHRsZXQgc2hhZGVyO1xuXG5cdFx0XHRpZiAoc2hhZGVyU2NyaXB0LnR5cGUgPT0gXCJ4LXNoYWRlci94LWZyYWdtZW50XCIpIHtcblx0XHRcdFx0c2hhZGVyID0gY29tcGlsZVNoYWRlcihzaGFkZXJTb3VyY2UsIGdsLkZSQUdNRU5UX1NIQURFUik7XG5cdFx0XHR9IGVsc2UgaWYgKHNoYWRlclNjcmlwdC50eXBlID09IFwieC1zaGFkZXIveC12ZXJ0ZXhcIikge1xuXHRcdFx0XHRzaGFkZXIgPSBjb21waWxlU2hhZGVyKHNoYWRlclNvdXJjZSwgZ2wuVkVSVEVYX1NIQURFUik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH07XG5cdFx0XHRyZXR1cm4gc2hhZGVyO1xuXHRcdH07XG5cblx0XHRsZXQgdmVydGV4U2hhZGVyID0gZ2V0U2hhZGVyKFwidmVydGV4LXNoYWRlclwiKTtcblx0XHRsZXQgZnJhZ21lbnRoYWRlciA9IGdldFNoYWRlcihcImZyYWdtZW50LXNoYWRlclwiKTtcblxuXHRcdGNvbnNvbGUuZGlyKHZlcnRleFNoYWRlciwgZnJhZ21lbnRoYWRlcik7XG5cblx0XHRsZXQgc2hhZGVyUHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcblx0XHRnbC5hdHRhY2hTaGFkZXIoc2hhZGVyUHJvZ3JhbSwgdmVydGV4U2hhZGVyKTtcblx0XHRnbC5hdHRhY2hTaGFkZXIoc2hhZGVyUHJvZ3JhbSwgZnJhZ21lbnRoYWRlcik7XG5cdFx0Z2wubGlua1Byb2dyYW0oc2hhZGVyUHJvZ3JhbSk7XG5cdFx0Z2wudXNlUHJvZ3JhbShzaGFkZXJQcm9ncmFtKTtcblxuXHRcdGdsLmRlbGV0ZVNoYWRlcih2ZXJ0ZXhTaGFkZXIpO1xuXHRcdGdsLmRlbGV0ZVNoYWRlcihmcmFnbWVudGhhZGVyKTtcblxuXHRcdGxldCB2ZXJ0ZXhQb3NpdGlvbkxvY2F0aW9uID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24oc2hhZGVyUHJvZ3JhbSwgXCJhVmVydGV4UG9zaXRpb25cIik7XG5cdFx0bGV0IGJ1ZmZlciA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xuXHRcdGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBidWZmZXIpO1xuXHRcdGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBuZXcgRmxvYXQzMkFycmF5KHZlcnRpY2VzKSwgZ2wuU1RBVElDX0RSQVcpO1xuXHRcdGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHZlcnRleFBvc2l0aW9uTG9jYXRpb24pO1xuXHRcdGdsLnZlcnRleEF0dHJpYlBvaW50ZXIodmVydGV4UG9zaXRpb25Mb2NhdGlvbiwgMiwgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcblxuXHRcdGxldCBkcmF3ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFUywgMCwgNik7XG5cdFx0fTtcblxuXHRcdGxldCByZW5kZXIgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZShyZW5kZXIpO1xuXHRcdFx0ZHJhdygpO1xuXHRcdH07XG5cblx0XHRyZW5kZXIoKTtcblx0fTtcblxuXG5cblx0cGFpbnRPdmVybGF5RWZmZWN0KCkge1xuXHRcdC8v0LHQtdGA0LXQvCDQuNC30L7QsdGA0LDQttC10L3QuNC40LUg0LjQtyDQv9C70LXQtdGA0LAg0LTQu9GPINCy0LjQtNC10L4g0YEg0Y3RhNGE0LXQutGC0L7QvCDRgdGC0LDRgNC40L3RiyDQsiDQutCw0L3QstCw0YEg0LTQu9GPINC+0YLRgNC40YHQstC+0LrQuCDRjdGE0YTQtdC60YLQsFxuXHRcdHRoaXMub3ZlcmxheUNhbnZhc0NvbnRleHQuZHJhd0ltYWdlKHRoaXMub3ZlcmxheVBsYXllci5wbGF5ZXJFbCwgMCwgMCwgdGhpcy5vdmVybGF5UGxheWVyLndpZHRoLCB0aGlzLm92ZXJsYXlQbGF5ZXIuaGVpZ2h0KTtcblx0XHRsZXQgaW1hZ2VEYXRhID0gdGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5jYW52YXNFbC53aWR0aCwgdGhpcy5jYW52YXNFbC5oZWlnaHQpO1xuXHRcdHRoaXMub3ZlcmxheUNhbnZhc0NvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG5cdFx0dGhpcy5jb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdtdWx0aXBseSc7XG5cdFx0Ly/QvtGC0YDQuNGB0L7QstGL0LLQsNC10Lwg0Y3RhNGE0LXQutGCINGBINGA0LXQttC40LzQvtC8INC90LDQu9C+0LbQtdC90LjRjyBtdWx0aXBseVxuXHRcdHRoaXMuY29udGV4dC5kcmF3SW1hZ2UodGhpcy5vdmVybGF5Q2FudmFzLCAwLCAwLCB0aGlzLmNhbnZhc0VsLndpZHRoLCB0aGlzLmNhbnZhc0VsLmhlaWdodCk7XG5cdFx0dGhpcy5jb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdzb3VyY2Utb3Zlcic7XG5cdH07XG5cblx0Ly/RhNGD0L3QutGG0LjRjyDQtNC70Y8g0L7RgtGA0LjRgdC+0LLQutC4INGB0YPQsdGC0LjRgtGA0L7QslxuXHRkcmF3VGV4dCh0ZXh0KSB7XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICdyZ2IoNTAsIDUwLCA1MCknO1xuXHRcdC8v0YTQvtC9XG5cdFx0dGhpcy5jb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0XHR0aGlzLmNvbnRleHQuZm9udCA9ICczNnB4IE9yYW5pZW5iYXVtJztcblx0XHR0aGlzLmNvbnRleHQudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcblx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYigyNTUsIDI1NSwgMjU1KSc7XG5cdFx0Ly/QtNC10LvQsNC10Lwg0L/QtdGA0LXQvdC+0YHRiyDQv9C+INGB0LvQvtCy0LDQvFxuXHRcdHRoaXMud3JhcFRleHQodGhpcy5zdWJzLnBhcnNlZFN1YnNbdGhpcy5zdWJzQ3VyctChdWVdLnRleHQsIHRoaXMuY2FudmFzRWwud2lkdGgsIDQwLCB0aGlzLmNhbnZhc0VsLndpZHRoIC8gMiwgdGhpcy5jYW52YXNFbC5oZWlnaHQgLyAyKTtcblx0XHQvL9C90LDQutC70LDQtNGL0LLQsNC10Lwg0Y3RhNGE0LXQutGCINGB0YLQsNGA0LjQvdGLXG5cdFx0dGhpcy5wYWludE92ZXJsYXlFZmZlY3QoKTtcblx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnZpZGVvUmVxKTtcblx0XHR0aGlzLnRleHRSZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcmF3VGV4dC5iaW5kKHRoaXMpKTtcblx0fTtcblxuXHQvL9C/0LXRgNC10L3QvtGBINGB0YPQsdGC0LjRgtGA0L7QsiDQv9C+INGB0LvQvtCy0LDQvFxuXHR3cmFwVGV4dCh0ZXh0LCBtYXhXaWR0aCwgbGluZUhlaWdodCwgbWFyZ2luTGVmdCwgbWFyZ2luVG9wKSB7XG5cdFx0bGV0IHdvcmRzID0gdGV4dC5zcGxpdChcIiBcIik7XG5cdFx0bGV0IGxpbmUgPSBcIlwiO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCB0ZW1wb3JhcnlUZXh0TGluZSA9IGxpbmUgKyB3b3Jkc1tpXSArIFwiIFwiO1xuXHRcdFx0Ly/Qv9C+0LvRg9GH0LDQtdC8INGI0LjRgNC40L3RgyDQu9C40L3QuNC4INGC0LXQutGB0YLQsFxuXHRcdFx0bGV0IHRlbXBvcmFyeVRleHRMaW5lV2lkdGggPSB0aGlzLmNvbnRleHQubWVhc3VyZVRleHQodGVtcG9yYXJ5VGV4dExpbmUpLndpZHRoO1xuXHRcdFx0Ly/Qv9GA0L7QstC10YDRj9C10Lwg0LLQu9Cw0LfQuNGCINC70Lgg0LIg0LrQsNC90LLQsNGBXG5cdFx0XHRpZiAodGVtcG9yYXJ5VGV4dExpbmVXaWR0aCA+IChtYXhXaWR0aCAtIDUwKSkge1xuXHRcdFx0XHR0aGlzLmNvbnRleHQuZmlsbFRleHQobGluZSwgbWFyZ2luTGVmdCwgbWFyZ2luVG9wKTtcblx0XHRcdFx0bGluZSA9IHdvcmRzW2ldICsgXCIgXCI7XG5cdFx0XHRcdG1hcmdpblRvcCArPSBsaW5lSGVpZ2h0O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bGluZSA9IHRlbXBvcmFyeVRleHRMaW5lO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdHRoaXMuY29udGV4dC5maWxsVGV4dChsaW5lLCBtYXJnaW5MZWZ0LCBtYXJnaW5Ub3ApO1xuXHR9O1xuXG5cdC8v0L/RgNC+0LLQtdGA0LrQsCDQtNC+0YHRgtGD0L/QvdC+0YHRgtC4INGB0YPQsdGC0LjRgtGA0L7QslxuXHRjaGVja1N1YnNBdmFpbGFiaWxpdHkoZSkge1xuXHRcdC8v0YTQu9Cw0LMg0YPRgdGC0LDQvdCw0LLQu9C40LLQsNC10YLRgdGPINC10YHQu9C4INGB0YPQsdGC0LjRgtGA0Ysg0LHRi9C70Lgg0YPRgdC/0LXRiNC90L4g0LfQsNCz0YDRg9C20LXQvdGLXG5cdFx0aWYgKCF0aGlzLnN1YnMucmVhZHkpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMucGxheWVyLnBhdXNlKCk7XG5cdFx0XHR0aGlzLnBsYXllci5wbGF5ZXJFbC5jdXJyZW50VGltZSA9IDA7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fTtcblx0fTtcbn07XG5cbmNsYXNzIFN1YnMge1xuXHRjb25zdHJ1Y3Rvcih1cmxNYXApIHtcblx0XHR0aGlzLnJlYWR5ID0gZmFsc2U7XG5cdFx0Ly/Qv9C+0LvRg9GH0LDQtdC8INGB0YPQsdGC0LjRgtGA0Ysg0L/QviB1cmxcblx0XHRmZXRjaCh1cmxNYXAuc3Vic1VybClcblx0XHRcdC50aGVuKHJlcyA9PiB7XG5cdFx0XHRcdC8v0L/QsNGA0YHQuNC8INGB0YPQsdGC0LjRgtGA0Ysg0LIg0YLQtdC60YHRglxuXHRcdFx0XHRyZXMudGV4dCgpXG5cdFx0XHRcdFx0LnRoZW4oZGF0YSA9PiB7XG5cdFx0XHRcdFx0XHQvL9C/0LDRgNGB0LjQvCDRgdGD0LHRgtC40YLRgNGLINCyIGpzXG5cdFx0XHRcdFx0XHR0aGlzLnBhcnNlZFN1YnMgPSB0aGlzLnBhcnNlRnJvbVNydChkYXRhKTtcblx0XHRcdFx0XHRcdHRoaXMucmVhZHkgPSB0cnVlO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdH07XG5cblx0Ly/Qv9Cw0YDRgdC40Lwg0YHRg9Cx0YLQuNGC0YDRi1xuXHRwYXJzZUZyb21TcnQoc3J0KSB7XG5cdFx0Ly/QuNC3INGC0LXQutGB0YLQsCDQsiBqcywg0L3QsNCz0LvQviwg0L/RgNC4INC/0L7QvNC+0YnQuCDQsdC40LHQu9C40L7RgtC10LrQuCBzdWJ0aXRsZS1wYXJzZXJcblx0XHRsZXQgcGFyc2VkU3VicyA9IHBhcnNlci5mcm9tU3J0KHNydCk7XG5cdFx0Ly/Qv9GA0LjQstC+0LTQuNC8INCy0YDQtdC80Y8g0Log0YTQvtGA0LzQsNGC0YMg0LzQuNC70LjRgdC10LrRg9C90LRcblx0XHRwYXJzZWRTdWJzLm1hcChpdGVtID0+IHtcblx0XHRcdHRpbWVQYXJzZVRvTXMoJ2VuZFRpbWUnLCBpdGVtKTtcblx0XHRcdHRpbWVQYXJzZVRvTXMoJ3N0YXJ0VGltZScsIGl0ZW0pO1xuXHRcdH0pO1xuXG5cdFx0ZnVuY3Rpb24gdGltZVBhcnNlVG9Ncyh0aW1lVHlwZSwgaXRlbSkge1xuXHRcdFx0bGV0IHN1YnNTdGFydFRpbWVCdWZmZXIgPSBpdGVtW3RpbWVUeXBlXS5zcGxpdCgnOicpO1xuXHRcdFx0bGV0IGhvdXJzID0gc3Vic1N0YXJ0VGltZUJ1ZmZlclswXTtcblx0XHRcdGxldCBtaW5zID0gTnVtYmVyKHN1YnNTdGFydFRpbWVCdWZmZXJbMV0pO1xuXHRcdFx0bGV0IHNlY3NBbmRNc2Vjc0J1ZmZlciA9IHN1YnNTdGFydFRpbWVCdWZmZXJbMl0uc3BsaXQoJywnKTtcblx0XHRcdGxldCBzZWNzID0gTnVtYmVyKHNlY3NBbmRNc2Vjc0J1ZmZlclswXSk7XG5cdFx0XHRsZXQgbXNlY3MgPSBOdW1iZXIoc2Vjc0FuZE1zZWNzQnVmZmVyWzFdKTtcblx0XHRcdGl0ZW1bdGltZVR5cGVdID0gaG91cnMgKiAzNjAwMDAwICsgbWlucyAqIDYwMDAwICsgc2VjcyAqIDEwMDAgKyBtc2Vjcztcblx0XHR9O1xuXHRcdHJldHVybiBwYXJzZWRTdWJzO1xuXHR9O1xufTtcblxuY2xhc3MgQXVkaW8ge1xuXHRjb25zdHJ1Y3RvcihlbCwgdXJsKSB7XG5cdFx0dGhpcy5hdWRpb0VsID0gZWw7XG5cdFx0dGhpcy51cmwgPSB1cmw7XG5cdFx0dGhpcy5hdWRpb1NvdXJjZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG5cdFx0dGhpcy5hdWRpb1NvdXJjZUVsLnNldEF0dHJpYnV0ZSgnc3JjJywgdGhpcy51cmwpO1xuXHRcdHRoaXMuYXVkaW9FbC5hcHBlbmRDaGlsZCh0aGlzLmF1ZGlvU291cmNlRWwpO1xuXHR9O1xuXHRwbGF5KCkge1xuXHRcdHRoaXMuYXVkaW9FbC5wbGF5KCk7XG5cdH07XG5cdHBhdXNlKCkge1xuXHRcdHRoaXMuYXVkaW9FbC5wYXVzZSgpO1xuXHR9O1xufTtcblxuY29uc3QgYXBwID0gbmV3IEFwcChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwJykpOyIsIlwidXNlIHN0cmljdFwiO1xuXG4vKtC60LvQsNGB0YEg0L/RgNC40LvQvtC20LXQvdC40Y8qL1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgQXBwID0gZnVuY3Rpb24gKCkge1xuXHRmdW5jdGlvbiBBcHAoZWwpIHtcblx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXBwKTtcblxuXHRcdHRoaXMuYXBwRWwgPSBlbDtcblx0XHR0aGlzLmZvcm0gPSB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5zb3VyY2UtbGlua3MtZm9ybScpO1xuXHRcdHRoaXMuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLl9vblNvdXJjZUxpbmtzRm9ybVN1Ym1pdC5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdF9jcmVhdGVDbGFzcyhBcHAsIFt7XG5cdFx0a2V5OiAnX29uU291cmNlTGlua3NGb3JtU3VibWl0JyxcblxuXG5cdFx0LyrQvtCx0YDQsNCx0L7RgtGH0LjQuiDRgdC+0LHRi9GC0LjRjyDQvtGC0L/RgNCw0LLQutC4INGE0L7RgNC80YsuINCh0L7QsdC40YDQsNC10YIg0LTQsNC90L3Ri9C1INC40Lcg0L/QvtC70LUg0Lgg0L7RgdGD0YnQtdGB0YLQstC70Y/QtdGCINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGOINGN0LvQtdC80LXQvdGC0L7QsiDQstGC0L7RgNC+0Lkg0YHRgtGA0LDQvdC40YbRiyovXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIF9vblNvdXJjZUxpbmtzRm9ybVN1Ym1pdChlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR2YXIgb3ZlcmxheVZpZGVvVXJsID0gJy4vYXNzZXRzL3ZpZGVvL292ZXJsYXkubXA0JzsgLy/QstC40LTQtdC+INC00LvRjyDRgdC+0LfQtNCw0L3QuNGPINGN0YTRhNC10LrRgtCwINGB0YLQsNGA0LjQvdGLXG5cdFx0XHR0aGlzLm92ZXJsYXlDYW52YXMgPSB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMtb3ZlcmxheScpOyAvL9GD0LfQtdC7INC60LDQvdCy0LDRgdCwINC00LvRjyDQvtGC0YDQuNGB0L7QstC60Lgg0Y3RhNC10LrRgtCwINGB0YLQsNGA0LjQvdGLXG5cblx0XHRcdC8q0YPRgNC70Ysg0LLQuNC00LXQviwg0LDRg9C00LjQviDQuCDRgdGD0LHRgtC40YLRgNC+0LIg0LLQstC10LTQtdC90L3Ri9C1INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC8Ki9cblx0XHRcdHRoaXMudXJsTWFwID0ge1xuXHRcdFx0XHR2aWRlb1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjdmlkZW9VcmwnKS52YWx1ZSxcblx0XHRcdFx0c3Vic1VybDogdGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcjc3ViVXJsJykudmFsdWUsXG5cdFx0XHRcdGF1ZGlvVXJsOiB0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJyNhdWRpb1VybCcpLnZhbHVlXG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5hcHBFbC5xdWVyeVNlbGVjdG9yKCcuaW5pdGlhbC1wYWdlJykuY2xhc3NMaXN0LmFkZCgnaW5pdGlhbC1wYWdlX2hpZGRlbicpOyAvL9GB0YLRgNCw0L3QuNGG0LAg0YEg0YTQvtGA0LzQvtC5XG5cdFx0XHR0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1wYWdlJykuY2xhc3NMaXN0LnJlbW92ZSgndmlkZW8tcGFnZV9oaWRkZW4nKTsgLy/RgdGC0YDQsNC90LjRhtCwINGBINCy0LjQtNC10L5cblx0XHRcdHRoaXMuc3VicyA9IG5ldyBTdWJzKHRoaXMudXJsTWFwKTsgLy/QuNC90YHRgtCw0L3RgSDQutC70LDRgdGB0LAg0LTQu9GPINGA0LDQsdC+0YLRiyDRgSDRgdGD0LHRgtC40YLRgNCw0LzQuFxuXHRcdFx0dGhpcy5wbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLnZpZGVvLWN1c3RvbScpLCB0aGlzLnVybE1hcC52aWRlb1VybCwgdGhpcy5zdWJzKTsgLy/QuNC90YHRgtCw0L3RgSDQv9C70LXQtdGA0LAg0LTQu9GPINC/0YDQvtC40LPRgNGL0LLQsNC90LjRjyDQt9Cw0LPRgNGD0LbQtdC90L3QvtCz0L4g0LLQuNC00LXQvlxuXHRcdFx0dGhpcy5vdmVybGF5UGxheWVyID0gbmV3IFBsYXllcih0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy52aWRlby1vdmVybGF5JyksIG92ZXJsYXlWaWRlb1VybCwgdGhpcy5zdWJzKTsgLy/QuNC90YHRgtCw0L3RgSDQv9C70LXQtdGA0LAg0LTQu9GPINC/0YDQvtC40YDRi9Cy0LDQvdC40Y8g0LLQuNC00LXQviDRgSDRjdGE0YTQtdC60YLQvtC8INGB0YLQsNGA0LjQvdGLXG5cdFx0XHR0aGlzLmF1ZGlvID0gbmV3IEF1ZGlvKHRoaXMuYXBwRWwucXVlcnlTZWxlY3RvcignLmF1ZGlvJyksIHRoaXMudXJsTWFwLmF1ZGlvVXJsKTsgLy/QuNC90YHRgtCw0L3RgSDQtNC70Y8g0YDQsNCx0L7RgtGLINGBINCw0YPQtNC40L5cblx0XHRcdHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyh0aGlzLmFwcEVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMnKSwgdGhpcy5wbGF5ZXIsIHRoaXMub3ZlcmxheVBsYXllciwgdGhpcy5zdWJzLCB0aGlzLm92ZXJsYXlDYW52YXMsIHRoaXMuYXVkaW8pO1xuXHRcdH1cblx0fV0pO1xuXG5cdHJldHVybiBBcHA7XG59KCk7XG5cbjtcblxuLyrQutC70LDRgdGBINC00LvRjyDQuNC90LjRhtC40LDQu9C40LfQsNGG0LjQuCDQstC40LTQtdC+0L/Qu9C10LXRgNCwKi9cblxudmFyIFBsYXllciA9IGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gUGxheWVyKGVsLCB1cmwsIHN1YnMpIHtcblx0XHRfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGxheWVyKTtcblxuXHRcdHRoaXMucGxheWVyRWwgPSBlbDtcblx0XHR0aGlzLnZpZGVvVXJsID0gdXJsO1xuXHRcdHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG5cdFx0dGhpcy53aWR0aCA9IDY0MDsgLy/RiNC40YDQuNC90LAg0LLQuNC00LXQvlxuXHRcdHRoaXMuaGVpZ2h0ID0gMzYwOyAvL9Cy0YvRgdC+0YLQsCDQstC40LTQtdC+XG5cdFx0dGhpcy5wbGF5ZXJFbC53aWR0aCA9IHRoaXMud2lkdGg7XG5cdFx0dGhpcy5wbGF5ZXJFbC5oZWlnaHQgPSB0aGlzLmhlaWdodDtcblx0XHR0aGlzLnZpZGVvU291cmNlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTsgLy/RgdC+0LfQtNCw0YLRjCDRjdC70LXQvNC10L3RgiA8c291cmNlPlxuXHRcdHRoaXMudmlkZW9Tb3VyY2VFbC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMudmlkZW9VcmwpOyAvL9GD0YHRgtCw0L3QvtCy0LjRgtGMINC40YHRgtC+0YfQvdC40Lpcblx0XHR0aGlzLnBsYXllckVsLmFwcGVuZENoaWxkKHRoaXMudmlkZW9Tb3VyY2VFbCk7IC8v0LTQvtCx0LDQstC40YLRjCA8c291cmNlPiDQstC90YPRgtGA0YwgPHZpZGVvPlxuXHR9XG5cblx0X2NyZWF0ZUNsYXNzKFBsYXllciwgW3tcblx0XHRrZXk6ICdwbGF5Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcGxheSgpIHtcblx0XHRcdHRoaXMucGxheWVyRWwucGxheSgpOyAvL9Cy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjQtSDQstC40LTQtdC+XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAncGF1c2UnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcblx0XHRcdHRoaXMucGxheWVyRWwucGF1c2UoKTsgLy/Qv9Cw0YPQt9CwXG5cdFx0fVxuXHR9XSk7XG5cblx0cmV0dXJuIFBsYXllcjtcbn0oKTtcblxuO1xuXG4vKtC60LvQsNGB0YEg0LTQu9GPINC40L3QuNGG0LjQsNC70LjQt9Cw0YbQuNC4INC60LDQvdCy0LDRgdCwKi9cblxudmFyIENhbnZhcyA9IGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gQ2FudmFzKGVsLCBwbGF5ZXIsIG92ZXJsYXlQbGF5ZXIsIHN1YnMsIG92ZXJsYXlDYW52YXMsIGF1ZGlvKSB7XG5cdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbnZhcyk7XG5cblx0XHR0aGlzLmNhbnZhc0VsID0gZWw7IC8v0YPQt9C10LsgPGNhbnZhcz4g0L3QsCDQutC+0YLQvtGA0L7QvCDQsdGD0LTQtdC8INGA0LjRgdC+0LLQsNGC0Yxcblx0XHR0aGlzLm92ZXJsYXlDYW52YXMgPSBvdmVybGF5Q2FudmFzOyAvLyDRg9C30LrQuyA8Y2FudmFzPiDQtNC70Y8g0L7RgtGA0LjRgdC+0LLQutC4INGN0YTQtdC10LrRgtCwINGB0YLQsNGA0LjQvdGLXG5cdFx0dGhpcy5wbGF5ZXIgPSBwbGF5ZXI7IC8v0L/Qu9C10LXRgCDQtNC70Y8g0L/RgNC+0LjQs9GA0YvQstCw0L3QuNGPINC30LDQs9GA0YPQttC10L3QvdC+0LPQviDQstC40LTQtdC+XG5cdFx0dGhpcy5vdmVybGF5UGxheWVyID0gb3ZlcmxheVBsYXllcjsgLy/Qv9C70LXQtdGAINC00LvRjyDQv9GA0L7QuNCz0YDRi9Cy0LDQvdC40Y8g0LLQuNC00LXQviDRgSDRjdGE0YTQtdC60YLQvtC8XG5cdFx0dGhpcy5zdWJzID0gc3ViczsgLy/QvtCx0YrQtdC60YIg0YEg0YDQsNGB0L/QsNGA0YHQtdC90L3Ri9C80Lgg0YHRg9Cx0YLQuNGC0YDQsNC80Lhcblx0XHR0aGlzLmF1ZGlvID0gYXVkaW87IC8v0LDRg9C00LjQvtC/0LvQtdC10YBcblx0XHR0aGlzLm92ZXJsYXlDYW52YXNDb250ZXh0ID0gdGhpcy5vdmVybGF5Q2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblx0XHR0aGlzLnN1YnNDdXJy0KF1ZSA9IDA7IC8v0L/QvtC30LjRhtC40Y8g0YLQtdC60YPRidC10Lkg0YDQtdC/0LvQuNC60Lgg0LIg0YHRg9Cx0YLQuNGC0YDQsNGFLCDQvNC10L3Rj9GP0LXRgtGB0Y8g0L/QvtGB0LvQtSDQv9C+0LrQsNC30LAg0LrQsNC20LTQvtC5INGE0YDQsNC30Ytcblx0XHR0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhc0VsLmdldENvbnRleHQoXCIyZFwiKTtcblx0XHR0aGlzLmNhbnZhc0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DYW52YXNDbGljay5iaW5kKHRoaXMpKTsgLy/QstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUv0L/QsNGD0LfQsCDQv9C+INC60LvQuNC60YNcblx0XHR0aGlzLmNhbnZhc0VsLndpZHRoID0gdGhpcy5wbGF5ZXIud2lkdGg7IC8v0YDQsNC30LzQtdGA0Ysg0LrQsNC90LLQsNGB0LAg0LTQu9GPINGA0LDQstC90Ysg0YDQsNC30LzQtdGA0YMg0LLQuNC00LXQvtC/0LvQtdC10YDQsFxuXHRcdHRoaXMuY2FudmFzRWwuaGVpZ2h0ID0gdGhpcy5wbGF5ZXIuaGVpZ2h0O1xuXHRcdHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAncmdiKDMwLCAzMCwgMzApJztcblx0XHR0aGlzLmNvbnRleHQuZmlsbFJlY3QoMCwgMCwgdGhpcy5jYW52YXNFbC53aWR0aCwgdGhpcy5jYW52YXNFbC5oZWlnaHQpO1xuXHR9XG5cblx0X2NyZWF0ZUNsYXNzKENhbnZhcywgW3tcblx0XHRrZXk6ICdfb25DYW52YXNDbGljaycsXG5cblxuXHRcdC8q0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNC1L9C/0LDRg9C30LAqL1xuXHRcdHZhbHVlOiBmdW5jdGlvbiBfb25DYW52YXNDbGljayhlKSB7XG5cdFx0XHRpZiAodGhpcy5wbGF5ZXIuaXNQbGF5aW5nKSB7XG5cdFx0XHRcdHRoaXMucGxheWVyLnBhdXNlKCk7IC8v0L7RgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0L/Qu9C10LXRgCDRgSDQt9Cw0LPRgNGD0LbQtdC90L3Ri9C8INCy0LjQtNC10L4g0Lgg0LLQuNC00LXQviDRgSDRjdGE0YTQtdC60YLQvtC8XG5cdFx0XHRcdHRoaXMub3ZlcmxheVBsYXllci5wYXVzZSgpO1xuXHRcdFx0XHR0aGlzLmF1ZGlvLnBhdXNlKCk7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnQxKTsgLy/QvtGH0LjRidCw0LXQvCDQuNC90YLQtdGA0LLQsNC70Ysg0L/QvtC60LDQt9CwINGB0YPQsdGC0LjRgtGA0L7QslxuXHRcdFx0XHRjbGVhclRpbWVvdXQodGhpcy50Mik7XG5cdFx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudGV4dFJlcSk7IC8v0L7Rh9C40YnQsNC10LwgZnJhbWUgcmVxdWVzdNGLINC+0YLRgNC40YHQvtCy0YvQstCw0Y7RidC40LUg0YLQtdC60YHRgiDQuCDQuNC30L7QsdGA0LDQttC10L3QuNC1XG5cdFx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudmlkZW9SZXEpO1xuXHRcdFx0XHR0aGlzLnBsYXllci5pc1BsYXlpbmcgPSAhdGhpcy5wbGF5ZXIuaXNQbGF5aW5nO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKHRoaXMuY2hlY2tTdWJzQXZhaWxhYmlsaXR5KGUpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdC8v0L/RgNC+0LLQtdGA0Y/QtdC8INC00L7RgdGC0YPQv9C90Ysg0LvQuCDRgdGD0LHRgtC40YLRgNGLXG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHR0aGlzLnN1YnMucGFyc2VkU3VicyA9IHRoaXMuZ2V0TmVlZGVkU3Vic0ZvclRoaXNUaW1lKCk7IC8v0YTQuNC70YzRgtGA0YPQtdC8INC80LDRgdC40LIg0YEg0YHRg9Cx0YLQuNGC0YDQsNC80Lgg0LIg0YHQvtC+0YLQstC10YLRgdGP0LLQuNC4INGBINGC0LXQutGD0YnQuNC8INCy0YDQtdC80LXQvdC10Lwg0L/RgNC+0LjQs9GA0YvQstCw0L3QuNGPXG5cdFx0XHRcdHRoaXMuc3Vic0N1cnLQoXVlID0gMDsgLy/QvdCw0YfQuNC90LDQtdC8INGBINC/0LXRgNCy0L7QuSDRgNC10L/Qu9C40LrQuFxuXHRcdFx0XHR0aGlzLnBsYXllci5wbGF5KCk7XG5cdFx0XHRcdHRoaXMub3ZlcmxheVBsYXllci5wbGF5KCk7XG5cdFx0XHRcdHRoaXMuYXVkaW8ucGxheSgpO1xuXHRcdFx0XHR0aGlzLnByZXBhcmVTaGFkZXJzKCk7XG5cdFx0XHRcdHRoaXMuc3RhcnRUaW1l0KFvdW50dXAoKTsgLy/QvdCw0YfQuNC90LDQtdC8INCy0YvRh9C40YHQu9GP0YLRjCDQstGA0LXQvNGPINC00L4g0L/QvtC60LDQt9CwINGB0YPQsdGC0LjRgtGA0L7QslxuXHRcdFx0XHRjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnRleHRSZXEpO1xuXHRcdFx0XHR0aGlzLnZpZGVvUmVxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMud2F0Y2hUaGVWaWRlby5iaW5kKHRoaXMpKTsgLy/QvtGC0YDQuNGB0L7QstGL0LLQsNC10Lwg0LrQsNC00YBcblx0XHRcdFx0dGhpcy5wbGF5ZXIuaXNQbGF5aW5nID0gIXRoaXMucGxheWVyLmlzUGxheWluZztcblx0XHRcdH07XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAnZ2V0TmVlZGVkU3Vic0ZvclRoaXNUaW1lJyxcblxuXG5cdFx0LyrRhNGD0L3QutGG0LjRjyDQtNC70Y8g0YTQuNC70YzRgtGA0LDRhtC40Lgg0YHRg9Cx0YLQuNGC0YDQvtCyINC/0YDQuCDQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40Lgg0L/QvtGB0LvQtSDQv9Cw0YPQt9GLINC40LvQuCDQv9C10YDQtdC80L7RgtC60LgqL1xuXHRcdHZhbHVlOiBmdW5jdGlvbiBnZXROZWVkZWRTdWJzRm9yVGhpc1RpbWUoKSB7XG5cdFx0XHR2YXIgY3VycmVudFRpbWUgPSBwYXJzZUludCh0aGlzLnBsYXllci5wbGF5ZXJFbC5jdXJyZW50VGltZSAqIDEwMDApO1xuXHRcdFx0dmFyIGZpbHRlcmVkU3VicyA9IHRoaXMuc3Vicy5wYXJzZWRTdWJzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRpZiAoaXRlbS5lbmRUaW1lID49IGN1cnJlbnRUaW1lKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH07XG5cdFx0XHR9KTtcblx0XHRcdHJldHVybiBmaWx0ZXJlZFN1YnM7IC8v0LLQvtC30LLRgtGA0LDRidCw0LXQvCDQvNCw0YHRgdC40LIg0YEg0YDQtdC/0LvQuNC60LDQvNC4INC90LDRh9C40L3QsNGPINGBINCx0LvQuNC20LDQudGI0LXQuVxuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ3Jlc3VtZVBsYXlBZnRlclN1YnMnLFxuXG5cblx0XHQvKtC/0YDQvtC00L7Qu9C20LDQtdC8INCy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjQtSDQstC40LTQtdC+LCDQv9C+0YHQu9C1INC/0L7QutCw0LfQsCDRgdGD0LHRgtC40YLRgNC+0LIqL1xuXHRcdHZhbHVlOiBmdW5jdGlvbiByZXN1bWVQbGF5QWZ0ZXJTdWJzKCkge1xuXHRcdFx0dGhpcy5wbGF5ZXIucGxheSgpO1xuXHRcdFx0dGhpcy5zdGFydFRpbWXQoW91bnR1cCgpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50ZXh0UmVxKTtcblx0XHRcdHRoaXMudmlkZW9SZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy53YXRjaFRoZVZpZGVvLmJpbmQodGhpcykpO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ3N0YXJ0VGltZdChb3VudHVwJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gc3RhcnRUaW1lT3VudHVwKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdFx0LyrQstGL0YfQuNGB0LvRj9C10Lwg0LLRgNC10LzRjyDQtNC+INC90LDRh9Cw0LvQsCDQv9C+0LrQsNC30LAg0YHRg9Cx0YLQuNGC0YDQvtCyKi9cblx0XHRcdHZhciBkZWxheVRvU3RhcnRPZlN1YnMgPSB0aGlzLnN1YnMucGFyc2VkU3Vic1t0aGlzLnN1YnNDdXJy0KF1ZV0uZW5kVGltZSAtIHBhcnNlSW50KHRoaXMucGxheWVyLnBsYXllckVsLmN1cnJlbnRUaW1lKSAqIDEwMDA7XG5cdFx0XHQvKtCy0YvRh9C40YHQu9GP0LXQvCDQstGA0LXQvNGPINC/0L7QutCw0LfQsCovXG5cdFx0XHR2YXIgcGF1c2VEdXJhdGlvbiA9IHRoaXMuc3Vicy5wYXJzZWRTdWJzW3RoaXMuc3Vic0N1cnLQoXVlXS5lbmRUaW1lIC0gdGhpcy5zdWJzLnBhcnNlZFN1YnNbdGhpcy5zdWJzQ3VyctChdWVdLnN0YXJ0VGltZTtcblxuXHRcdFx0LyrQttC00LXQvCDQv9C+0LrQsCDQv9GA0LjQudC00LXRgiDQstGA0LXQvNGPINC/0L7QutCw0LfQsNGC0Ywg0YHRg9Cx0YLQuNGC0YDRiyovXG5cdFx0XHR0aGlzLnQxID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdF90aGlzLnBsYXllci5wYXVzZSgpO1xuXHRcdFx0XHRjYW5jZWxBbmltYXRpb25GcmFtZShfdGhpcy52aWRlb1JlcSk7XG5cdFx0XHRcdC8v0YDQuNGB0YPQtdC8INGB0YPQsdGC0LjRgtGA0Ytcblx0XHRcdFx0X3RoaXMudGV4dFJlcSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShfdGhpcy5kcmF3VGV4dC5iaW5kKF90aGlzKSk7XG5cdFx0XHRcdGNsZWFyVGltZW91dChfdGhpcy50MSk7XG5cblx0XHRcdFx0LyrQttC00LXQvCDQv9C+0LrQsCDQv9GA0LjQudC00LXRgiDQstGA0LXQvNGPINC/0YDQvtC00L7Qu9C20LjRgtGMINCy0L7RgdC/0YDQvtC40LfQstC10LTQtdC90LjQtSovXG5cdFx0XHRcdF90aGlzLnQyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0LyrQv9GA0L7QstC10YDRj9C10Lwg0L3QtSDQt9Cw0LrQvtC90YfQuNC70LjRgdGMINC70Lgg0YHRg9Cx0YLQuNGC0YDRiyovXG5cdFx0XHRcdFx0aWYgKF90aGlzLnN1YnNDdXJy0KF1ZSA8IF90aGlzLnN1YnMucGFyc2VkU3Vicy5sZW5ndGggLSAxKSB7XG5cdFx0XHRcdFx0XHRfdGhpcy5zdWJzQ3VyctChdWUrKztcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X3RoaXMuc3Vic0N1cnLQoXVlID0gMDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0X3RoaXMucmVzdW1lUGxheUFmdGVyU3VicygpO1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dChfdGhpcy50Mik7XG5cdFx0XHRcdH0sIHBhdXNlRHVyYXRpb24pO1xuXHRcdFx0fSwgZGVsYXlUb1N0YXJ0T2ZTdWJzKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICd3YXRjaFRoZVZpZGVvJyxcblxuXG5cdFx0Ly/RgNC40YHRg9C10Lwg0LrQsNC00YAg0YEg0L/QtdGA0LXQvtC00LjRh9C90L7RgdGC0YzRjiDQutCw0LTRgNC+0LIg0LIg0YHQtdC6XG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHdhdGNoVGhlVmlkZW8oKSB7XG5cdFx0XHR0aGlzLnBhaW50RnJhbWUoKTtcblx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudGV4dFJlcSk7XG5cdFx0XHR0aGlzLnZpZGVvUmVxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMud2F0Y2hUaGVWaWRlby5iaW5kKHRoaXMpKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICdwYWludEZyYW1lJyxcblxuXG5cdFx0Ly/RhNGD0L3QutGG0LjRjyDQvtGC0YDQuNGB0L7QstC60Lgg0LrQsNC00YDQsCDRgSDRjdGE0YTQtdC60YLQvtC8IGdyYXlzY2FsZVxuXHRcdHZhbHVlOiBmdW5jdGlvbiBwYWludEZyYW1lKCkge1xuXHRcdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZSh0aGlzLnBsYXllci5wbGF5ZXJFbCwgMCwgMCwgdGhpcy5wbGF5ZXIud2lkdGgsIHRoaXMucGxheWVyLmhlaWdodCk7XG5cdFx0XHQvL9GA0LXQttC40Lwg0L3QsNC70L7QttC10L3QuNGPINC/0L7Qt9Cy0L7Qu9GP0LXRgiDQtNC+0LHQuNGC0YHRjyDRh9C10YDQvdC+LdCx0LXQu9C+0Lkg0LrQsNGA0YLQuNC90LrQuFxuXHRcdFx0dGhpcy5jb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdjb2xvcic7XG5cdFx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYigyNTUsIDI1NSwgMjU1KSc7XG5cdFx0XHR0aGlzLmNvbnRleHQuZmlsbFJlY3QoMCwgMCwgdGhpcy5jYW52YXNFbC53aWR0aCwgdGhpcy5jYW52YXNFbC5oZWlnaHQpO1xuXHRcdFx0Ly/RgNC40YHRg9C10Lwg0Y3RhNGE0LXQutGCINGB0YLQsNGA0LjQvdGLXG5cdFx0XHR0aGlzLnBhaW50T3ZlcmxheUVmZmVjdCgpO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ3ByZXBhcmVTaGFkZXJzJyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcHJlcGFyZVNoYWRlcnMoKSB7XG5cdFx0XHR2YXIgdmVydGljZXMgPSBbLTEuMCwgLTEuMCwgMS4wLCAtMS4wLCAtMS4wLCAxLjAsIC0xLjAsIDEuMCwgMS4wLCAtMS4wLCAxLjAsIDEuMF07XG5cblx0XHRcdHZhciB3ZWJnbENhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYW52YXMtd2ViZ2wnKTtcblx0XHRcdHZhciBnbCA9IHdlYmdsQ2FudmFzLmdldENvbnRleHQoXCJleHBlcmltZW50YWwtd2ViZ2xcIik7XG5cblx0XHRcdHZhciBjb21waWxlU2hhZGVyID0gZnVuY3Rpb24gY29tcGlsZVNoYWRlcihzaGFkZXJTb3VyY2UsIHNoYWRlclR5cGUpIHtcblx0XHRcdFx0dmFyIHNoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcihzaGFkZXJUeXBlKTtcblx0XHRcdFx0Z2wuc2hhZGVyU291cmNlKHNoYWRlciwgc2hhZGVyU291cmNlKTtcblx0XHRcdFx0Z2wuY29tcGlsZVNoYWRlcihzaGFkZXIpO1xuXHRcdFx0XHRyZXR1cm4gc2hhZGVyO1xuXHRcdFx0fTtcblxuXHRcdFx0dmFyIGdldFNoYWRlciA9IGZ1bmN0aW9uIGdldFNoYWRlcihpZCkge1xuXHRcdFx0XHR2YXIgc2hhZGVyU2NyaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuXHRcdFx0XHR2YXIgc2hhZGVyU291cmNlID0gXCJcIjtcblx0XHRcdFx0dmFyIHRleHRMaW5lID0gc2hhZGVyU2NyaXB0LmZpcnN0Q2hpbGQ7XG5cdFx0XHRcdHdoaWxlICh0ZXh0TGluZSkge1xuXHRcdFx0XHRcdGlmICh0ZXh0TGluZS5ub2RlVHlwZSA9PSAzKSB7XG5cdFx0XHRcdFx0XHRzaGFkZXJTb3VyY2UgKz0gdGV4dExpbmUudGV4dENvbnRlbnQ7XG5cdFx0XHRcdFx0XHR0ZXh0TGluZSA9IHRleHRMaW5lLm5leHRTaWJsaW5nO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0dmFyIHNoYWRlciA9IHZvaWQgMDtcblxuXHRcdFx0XHRpZiAoc2hhZGVyU2NyaXB0LnR5cGUgPT0gXCJ4LXNoYWRlci94LWZyYWdtZW50XCIpIHtcblx0XHRcdFx0XHRzaGFkZXIgPSBjb21waWxlU2hhZGVyKHNoYWRlclNvdXJjZSwgZ2wuRlJBR01FTlRfU0hBREVSKTtcblx0XHRcdFx0fSBlbHNlIGlmIChzaGFkZXJTY3JpcHQudHlwZSA9PSBcIngtc2hhZGVyL3gtdmVydGV4XCIpIHtcblx0XHRcdFx0XHRzaGFkZXIgPSBjb21waWxlU2hhZGVyKHNoYWRlclNvdXJjZSwgZ2wuVkVSVEVYX1NIQURFUik7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH07XG5cdFx0XHRcdHJldHVybiBzaGFkZXI7XG5cdFx0XHR9O1xuXG5cdFx0XHR2YXIgdmVydGV4U2hhZGVyID0gZ2V0U2hhZGVyKFwidmVydGV4LXNoYWRlclwiKTtcblx0XHRcdHZhciBmcmFnbWVudGhhZGVyID0gZ2V0U2hhZGVyKFwiZnJhZ21lbnQtc2hhZGVyXCIpO1xuXG5cdFx0XHRjb25zb2xlLmRpcih2ZXJ0ZXhTaGFkZXIsIGZyYWdtZW50aGFkZXIpO1xuXG5cdFx0XHR2YXIgc2hhZGVyUHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcblx0XHRcdGdsLmF0dGFjaFNoYWRlcihzaGFkZXJQcm9ncmFtLCB2ZXJ0ZXhTaGFkZXIpO1xuXHRcdFx0Z2wuYXR0YWNoU2hhZGVyKHNoYWRlclByb2dyYW0sIGZyYWdtZW50aGFkZXIpO1xuXHRcdFx0Z2wubGlua1Byb2dyYW0oc2hhZGVyUHJvZ3JhbSk7XG5cdFx0XHRnbC51c2VQcm9ncmFtKHNoYWRlclByb2dyYW0pO1xuXG5cdFx0XHRnbC5kZWxldGVTaGFkZXIodmVydGV4U2hhZGVyKTtcblx0XHRcdGdsLmRlbGV0ZVNoYWRlcihmcmFnbWVudGhhZGVyKTtcblxuXHRcdFx0dmFyIHZlcnRleFBvc2l0aW9uTG9jYXRpb24gPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihzaGFkZXJQcm9ncmFtLCBcImFWZXJ0ZXhQb3NpdGlvblwiKTtcblx0XHRcdHZhciBidWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTtcblx0XHRcdGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBidWZmZXIpO1xuXHRcdFx0Z2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpLCBnbC5TVEFUSUNfRFJBVyk7XG5cdFx0XHRnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSh2ZXJ0ZXhQb3NpdGlvbkxvY2F0aW9uKTtcblx0XHRcdGdsLnZlcnRleEF0dHJpYlBvaW50ZXIodmVydGV4UG9zaXRpb25Mb2NhdGlvbiwgMiwgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcblxuXHRcdFx0dmFyIGRyYXcgPSBmdW5jdGlvbiBkcmF3KCkge1xuXHRcdFx0XHRnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFUywgMCwgNik7XG5cdFx0XHR9O1xuXG5cdFx0XHR2YXIgcmVuZGVyID0gZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUocmVuZGVyKTtcblx0XHRcdFx0ZHJhdygpO1xuXHRcdFx0fTtcblxuXHRcdFx0cmVuZGVyKCk7XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAncGFpbnRPdmVybGF5RWZmZWN0Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcGFpbnRPdmVybGF5RWZmZWN0KCkge1xuXHRcdFx0Ly/QsdC10YDQtdC8INC40LfQvtCx0YDQsNC20LXQvdC40LjQtSDQuNC3INC/0LvQtdC10YDQsCDQtNC70Y8g0LLQuNC00LXQviDRgSDRjdGE0YTQtdC60YLQvtC8INGB0YLQsNGA0LjQvdGLINCyINC60LDQvdCy0LDRgSDQtNC70Y8g0L7RgtGA0LjRgdCy0L7QutC4INGN0YTRhNC10LrRgtCwXG5cdFx0XHR0aGlzLm92ZXJsYXlDYW52YXNDb250ZXh0LmRyYXdJbWFnZSh0aGlzLm92ZXJsYXlQbGF5ZXIucGxheWVyRWwsIDAsIDAsIHRoaXMub3ZlcmxheVBsYXllci53aWR0aCwgdGhpcy5vdmVybGF5UGxheWVyLmhlaWdodCk7XG5cdFx0XHR2YXIgaW1hZ2VEYXRhID0gdGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgdGhpcy5jYW52YXNFbC53aWR0aCwgdGhpcy5jYW52YXNFbC5oZWlnaHQpO1xuXHRcdFx0dGhpcy5vdmVybGF5Q2FudmFzQ29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcblx0XHRcdHRoaXMuY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnbXVsdGlwbHknO1xuXHRcdFx0Ly/QvtGC0YDQuNGB0L7QstGL0LLQsNC10Lwg0Y3RhNGE0LXQutGCINGBINGA0LXQttC40LzQvtC8INC90LDQu9C+0LbQtdC90LjRjyBtdWx0aXBseVxuXHRcdFx0dGhpcy5jb250ZXh0LmRyYXdJbWFnZSh0aGlzLm92ZXJsYXlDYW52YXMsIDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0XHRcdHRoaXMuY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInO1xuXHRcdH1cblx0fSwge1xuXHRcdGtleTogJ2RyYXdUZXh0JyxcblxuXG5cdFx0Ly/RhNGD0L3QutGG0LjRjyDQtNC70Y8g0L7RgtGA0LjRgdC+0LLQutC4INGB0YPQsdGC0LjRgtGA0L7QslxuXHRcdHZhbHVlOiBmdW5jdGlvbiBkcmF3VGV4dCh0ZXh0KSB7XG5cdFx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYig1MCwgNTAsIDUwKSc7XG5cdFx0XHQvL9GE0L7QvVxuXHRcdFx0dGhpcy5jb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuY2FudmFzRWwud2lkdGgsIHRoaXMuY2FudmFzRWwuaGVpZ2h0KTtcblx0XHRcdHRoaXMuY29udGV4dC5mb250ID0gJzM2cHggT3JhbmllbmJhdW0nO1xuXHRcdFx0dGhpcy5jb250ZXh0LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XG5cdFx0XHR0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JnYigyNTUsIDI1NSwgMjU1KSc7XG5cdFx0XHQvL9C00LXQu9Cw0LXQvCDQv9C10YDQtdC90L7RgdGLINC/0L4g0YHQu9C+0LLQsNC8XG5cdFx0XHR0aGlzLndyYXBUZXh0KHRoaXMuc3Vicy5wYXJzZWRTdWJzW3RoaXMuc3Vic0N1cnLQoXVlXS50ZXh0LCB0aGlzLmNhbnZhc0VsLndpZHRoLCA0MCwgdGhpcy5jYW52YXNFbC53aWR0aCAvIDIsIHRoaXMuY2FudmFzRWwuaGVpZ2h0IC8gMik7XG5cdFx0XHQvL9C90LDQutC70LDQtNGL0LLQsNC10Lwg0Y3RhNGE0LXQutGCINGB0YLQsNGA0LjQvdGLXG5cdFx0XHR0aGlzLnBhaW50T3ZlcmxheUVmZmVjdCgpO1xuXHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy52aWRlb1JlcSk7XG5cdFx0XHR0aGlzLnRleHRSZXEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5kcmF3VGV4dC5iaW5kKHRoaXMpKTtcblx0XHR9XG5cdH0sIHtcblx0XHRrZXk6ICd3cmFwVGV4dCcsXG5cblxuXHRcdC8v0L/QtdGA0LXQvdC+0YEg0YHRg9Cx0YLQuNGC0YDQvtCyINC/0L4g0YHQu9C+0LLQsNC8XG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHdyYXBUZXh0KHRleHQsIG1heFdpZHRoLCBsaW5lSGVpZ2h0LCBtYXJnaW5MZWZ0LCBtYXJnaW5Ub3ApIHtcblx0XHRcdHZhciB3b3JkcyA9IHRleHQuc3BsaXQoXCIgXCIpO1xuXHRcdFx0dmFyIGxpbmUgPSBcIlwiO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgdGVtcG9yYXJ5VGV4dExpbmUgPSBsaW5lICsgd29yZHNbaV0gKyBcIiBcIjtcblx0XHRcdFx0Ly/Qv9C+0LvRg9GH0LDQtdC8INGI0LjRgNC40L3RgyDQu9C40L3QuNC4INGC0LXQutGB0YLQsFxuXHRcdFx0XHR2YXIgdGVtcG9yYXJ5VGV4dExpbmVXaWR0aCA9IHRoaXMuY29udGV4dC5tZWFzdXJlVGV4dCh0ZW1wb3JhcnlUZXh0TGluZSkud2lkdGg7XG5cdFx0XHRcdC8v0L/RgNC+0LLQtdGA0Y/QtdC8INCy0LvQsNC30LjRgiDQu9C4INCyINC60LDQvdCy0LDRgVxuXHRcdFx0XHRpZiAodGVtcG9yYXJ5VGV4dExpbmVXaWR0aCA+IG1heFdpZHRoIC0gNTApIHtcblx0XHRcdFx0XHR0aGlzLmNvbnRleHQuZmlsbFRleHQobGluZSwgbWFyZ2luTGVmdCwgbWFyZ2luVG9wKTtcblx0XHRcdFx0XHRsaW5lID0gd29yZHNbaV0gKyBcIiBcIjtcblx0XHRcdFx0XHRtYXJnaW5Ub3AgKz0gbGluZUhlaWdodDtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRsaW5lID0gdGVtcG9yYXJ5VGV4dExpbmU7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdFx0dGhpcy5jb250ZXh0LmZpbGxUZXh0KGxpbmUsIG1hcmdpbkxlZnQsIG1hcmdpblRvcCk7XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAnY2hlY2tTdWJzQXZhaWxhYmlsaXR5JyxcblxuXG5cdFx0Ly/Qv9GA0L7QstC10YDQutCwINC00L7RgdGC0YPQv9C90L7RgdGC0Lgg0YHRg9Cx0YLQuNGC0YDQvtCyXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIGNoZWNrU3Vic0F2YWlsYWJpbGl0eShlKSB7XG5cdFx0XHQvL9GE0LvQsNCzINGD0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdGC0YHRjyDQtdGB0LvQuCDRgdGD0LHRgtC40YLRgNGLINCx0YvQu9C4INGD0YHQv9C10YjQvdC+INC30LDQs9GA0YPQttC10L3Ri1xuXHRcdFx0aWYgKCF0aGlzLnN1YnMucmVhZHkpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR0aGlzLnBsYXllci5wYXVzZSgpO1xuXHRcdFx0XHR0aGlzLnBsYXllci5wbGF5ZXJFbC5jdXJyZW50VGltZSA9IDA7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH07XG5cdFx0fVxuXHR9XSk7XG5cblx0cmV0dXJuIENhbnZhcztcbn0oKTtcblxuO1xuXG52YXIgU3VicyA9IGZ1bmN0aW9uICgpIHtcblx0ZnVuY3Rpb24gU3Vicyh1cmxNYXApIHtcblx0XHR2YXIgX3RoaXMyID0gdGhpcztcblxuXHRcdF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdWJzKTtcblxuXHRcdHRoaXMucmVhZHkgPSBmYWxzZTtcblx0XHQvL9C/0L7Qu9GD0YfQsNC10Lwg0YHRg9Cx0YLQuNGC0YDRiyDQv9C+IHVybFxuXHRcdGZldGNoKHVybE1hcC5zdWJzVXJsKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcblx0XHRcdC8v0L/QsNGA0YHQuNC8INGB0YPQsdGC0LjRgtGA0Ysg0LIg0YLQtdC60YHRglxuXHRcdFx0cmVzLnRleHQoKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdC8v0L/QsNGA0YHQuNC8INGB0YPQsdGC0LjRgtGA0Ysg0LIganNcblx0XHRcdFx0X3RoaXMyLnBhcnNlZFN1YnMgPSBfdGhpczIucGFyc2VGcm9tU3J0KGRhdGEpO1xuXHRcdFx0XHRfdGhpczIucmVhZHkgPSB0cnVlO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRfY3JlYXRlQ2xhc3MoU3VicywgW3tcblx0XHRrZXk6ICdwYXJzZUZyb21TcnQnLFxuXG5cblx0XHQvL9C/0LDRgNGB0LjQvCDRgdGD0LHRgtC40YLRgNGLXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHBhcnNlRnJvbVNydChzcnQpIHtcblx0XHRcdC8v0LjQtyDRgtC10LrRgdGC0LAg0LIganMsINC90LDQs9C70L4sINC/0YDQuCDQv9C+0LzQvtGJ0Lgg0LHQuNCx0LvQuNC+0YLQtdC60Lggc3VidGl0bGUtcGFyc2VyXG5cdFx0XHR2YXIgcGFyc2VkU3VicyA9IHBhcnNlci5mcm9tU3J0KHNydCk7XG5cdFx0XHQvL9C/0YDQuNCy0L7QtNC40Lwg0LLRgNC10LzRjyDQuiDRhNC+0YDQvNCw0YLRgyDQvNC40LvQuNGB0LXQutGD0L3QtFxuXHRcdFx0cGFyc2VkU3Vicy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0dGltZVBhcnNlVG9NcygnZW5kVGltZScsIGl0ZW0pO1xuXHRcdFx0XHR0aW1lUGFyc2VUb01zKCdzdGFydFRpbWUnLCBpdGVtKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRmdW5jdGlvbiB0aW1lUGFyc2VUb01zKHRpbWVUeXBlLCBpdGVtKSB7XG5cdFx0XHRcdHZhciBzdWJzU3RhcnRUaW1lQnVmZmVyID0gaXRlbVt0aW1lVHlwZV0uc3BsaXQoJzonKTtcblx0XHRcdFx0dmFyIGhvdXJzID0gc3Vic1N0YXJ0VGltZUJ1ZmZlclswXTtcblx0XHRcdFx0dmFyIG1pbnMgPSBOdW1iZXIoc3Vic1N0YXJ0VGltZUJ1ZmZlclsxXSk7XG5cdFx0XHRcdHZhciBzZWNzQW5kTXNlY3NCdWZmZXIgPSBzdWJzU3RhcnRUaW1lQnVmZmVyWzJdLnNwbGl0KCcsJyk7XG5cdFx0XHRcdHZhciBzZWNzID0gTnVtYmVyKHNlY3NBbmRNc2Vjc0J1ZmZlclswXSk7XG5cdFx0XHRcdHZhciBtc2VjcyA9IE51bWJlcihzZWNzQW5kTXNlY3NCdWZmZXJbMV0pO1xuXHRcdFx0XHRpdGVtW3RpbWVUeXBlXSA9IGhvdXJzICogMzYwMDAwMCArIG1pbnMgKiA2MDAwMCArIHNlY3MgKiAxMDAwICsgbXNlY3M7XG5cdFx0XHR9O1xuXHRcdFx0cmV0dXJuIHBhcnNlZFN1YnM7XG5cdFx0fVxuXHR9XSk7XG5cblx0cmV0dXJuIFN1YnM7XG59KCk7XG5cbjtcblxudmFyIEF1ZGlvID0gZnVuY3Rpb24gKCkge1xuXHRmdW5jdGlvbiBBdWRpbyhlbCwgdXJsKSB7XG5cdFx0X2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1ZGlvKTtcblxuXHRcdHRoaXMuYXVkaW9FbCA9IGVsO1xuXHRcdHRoaXMudXJsID0gdXJsO1xuXHRcdHRoaXMuYXVkaW9Tb3VyY2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuXHRcdHRoaXMuYXVkaW9Tb3VyY2VFbC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMudXJsKTtcblx0XHR0aGlzLmF1ZGlvRWwuYXBwZW5kQ2hpbGQodGhpcy5hdWRpb1NvdXJjZUVsKTtcblx0fVxuXG5cdF9jcmVhdGVDbGFzcyhBdWRpbywgW3tcblx0XHRrZXk6ICdwbGF5Jyxcblx0XHR2YWx1ZTogZnVuY3Rpb24gcGxheSgpIHtcblx0XHRcdHRoaXMuYXVkaW9FbC5wbGF5KCk7XG5cdFx0fVxuXHR9LCB7XG5cdFx0a2V5OiAncGF1c2UnLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcblx0XHRcdHRoaXMuYXVkaW9FbC5wYXVzZSgpO1xuXHRcdH1cblx0fV0pO1xuXG5cdHJldHVybiBBdWRpbztcbn0oKTtcblxuO1xuXG52YXIgYXBwID0gbmV3IEFwcChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwJykpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
